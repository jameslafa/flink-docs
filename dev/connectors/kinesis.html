<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.4-SNAPSHOT Documentation: Amazon AWS Kinesis Streams Connector</title>
    <link rel="shortcut icon" href="/flink-docs/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/flink-docs/page/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/flink-docs/page/css/flink.css">
    <link rel="stylesheet" href="/flink-docs/page/css/syntax.css">
    <link rel="stylesheet" href="/flink-docs/page/css/codetabs.css">
    <link rel="stylesheet" href="/flink-docs/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          







  
    
    
    
      
    
  

  
    
    
    
      
    
  

  
    
    
    
      
    
  

  
    
    
    
      









  





<div class="sidenav-logo">
  <p><a href="/flink-docs"><img class="bottom" alt="Apache Flink" src="/flink-docs/page/img/navbar-brand-logo.jpg"></a> v1.4-SNAPSHOT</p>
</div>
<ul id="sidenav">

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/index.html"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li>
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/concepts/programming-model.html">Programming Model</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/concepts/runtime.html">Distributed Runtime</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/setup_quickstart.html"><i class="fa fa-power-off title appetizer" aria-hidden="true"></i> Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-7" data-toggle="collapse"><i class="fa fa-file-code-o title appetizer" aria-hidden="true"></i> Examples <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-7"><ul>
  <li><a href="/flink-docs/examples/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/run_example_quickstart.html">Monitoring Wikipedia Edits</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/examples.html">Batch Examples</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-11" data-toggle="collapse"><i class="fa fa-book title appetizer" aria-hidden="true"></i> Cookbooks <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-11"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/cookbooks/join-streams.html">Join Streams</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/cookbooks/pattern-detection.html">Pattern Detection with CEP</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Project Setup <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/java_api_quickstart.html">Sample Project in Java</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/scala_api_quickstart.html">Sample Project in Scala</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/linking_with_flink.html">Linking with Flink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/ide_setup.html">IDE Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/scala_shell.html">Scala REPL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/linking.html">Linking with Optional Modules</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/start/flink_on_windows.html">Running Flink on Windows</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/start/building.html">Building Flink from Source</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-25" data-toggle="collapse" class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</a><div class="collapse in" id="collapse-25"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-26" data-toggle="collapse">Basic API Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-26"><ul>
  <li><a href="/flink-docs/dev/api_concepts.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/scala_api_extensions.html">Scala API Extensions</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/java8.html">Java 8</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-30" data-toggle="collapse" class="active">Streaming (DataStream API)</a><div class="collapse in" id="collapse-30"><ul>
  <li><a href="/flink-docs/dev/datastream_api.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-31" data-toggle="collapse">Event Time <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-31"><ul>
  <li><a href="/flink-docs/dev/event_time.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/event_timestamps_watermarks.html">Generating Timestamps / Watermarks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/event_timestamp_extractors.html">Pre-defined Timestamp Extractors / Watermark Emitters</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-35" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-35"><ul>
  <li><a href="/flink-docs/dev/stream/state/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/state.html">Working with State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/checkpointing.html">Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/queryable_state.html">Queryable State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/custom_serialization.html">Custom Serialization</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-42" data-toggle="collapse">Operators <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-42"><ul>
  <li><a href="/flink-docs/dev/stream/operators/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/dev/stream/operators/windows.html">Windows</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/operators/process_function.html">Process Function</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/operators/asyncio.html">Async I/O</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-47" data-toggle="collapse" class="active">Connectors</a><div class="collapse in" id="collapse-47"><ul>
  <li><a href="/flink-docs/dev/connectors/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/guarantees.html">Fault Tolerance Guarantees</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/kafka.html">Kafka</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/cassandra.html">Cassandra</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/kinesis.html" class="active">Kinesis</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/filesystem_sink.html">Rolling File Sink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/nifi.html">NiFi</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/twitter.html">Twitter</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/side_output.html">Side Outputs</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/dev/stream/testing.html">Testing</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-61" data-toggle="collapse">Batch (DataSet API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-61"><ul>
  <li><a href="/flink-docs/dev/batch/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/dataset_transformations.html">Transformations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/iterations.html">Iterations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/fault_tolerance.html">Fault Tolerance</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/python.html">Python API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/connectors.html">Connectors</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/hadoop_compatibility.html">Hadoop Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/local_execution.html">Local Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/cluster_execution.html">Cluster Execution</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-72" data-toggle="collapse">Table API & SQL <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-72"><ul>
  <li><a href="/flink-docs/dev/table/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/common.html">Concepts & Common API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/streaming.html">Streaming Concepts</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/tableApi.html">Table API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/sql.html">SQL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/sourceSinks.html">Table Sources & Sinks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/udfs.html">User-defined Functions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-80" data-toggle="collapse">Data Types & Serialization <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-80"><ul>
  <li><a href="/flink-docs/dev/types_serialization.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/custom_serializers.html">Custom Serializers</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-83" data-toggle="collapse">Managing Execution <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-83"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/execution_configuration.html">Execution Configuration</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/packaging.html">Program Packaging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/parallel.html">Parallel Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/execution_plans.html">Execution Plans</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/restart_strategies.html">Restart Strategies</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-90" data-toggle="collapse">Libraries <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-90"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/cep.html">Event Processing (CEP)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/storm_compatibility.html">Storm Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-93" data-toggle="collapse">Graphs: Gelly <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-93"><ul>
  <li><a href="/flink-docs/dev/libs/gelly/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_api.html">Graph API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/library_methods.html">Library Methods</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-101" data-toggle="collapse">Machine Learning <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-101"><ul>
  <li><a href="/flink-docs/dev/libs/ml/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/quickstart.html">Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/multiple_linear_regression.html">Multiple Linear Regression</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/cross_validation.html">Cross Validation</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/distance_metrics.html">Distance Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/knn.html">k-Nearest Neighbors Join</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/min_max_scaler.html">MinMax Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/contribution_guide.html">How to Contribute</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/pipelines.html">Pipelines</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/polynomial_features.html">Polynomial Features</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/als.html">ALS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/sos.html">Stochastic Outlier Selection</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/standard_scaler.html">Standard Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/svm.html">SVM using CoCoA</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/best_practices.html">Best Practices</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/migration.html">API Migration Guides</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-120" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment & Operations <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-121" data-toggle="collapse">Clusters & Deployment <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-121"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/cluster_setup.html">Standalone Cluster</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/yarn_setup.html">YARN</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/mesos.html">Mesos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/docker.html">Docker</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/kubernetes.html">Kubernetes</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/aws.html">AWS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/gce_setup.html">Google Compute Engine</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/mapr_setup.html">MapR</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/jobmanager_high_availability.html">High Availability (HA)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-132" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/checkpoints.html">Checkpoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/savepoints.html">Savepoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/ops/config.html">Configuration</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/production_ready.html">Production Readiness Checklist</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/cli.html">CLI</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/security-kerberos.html">Kerberos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/security-ssl.html">SSL Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/upgrading.html">Upgrading Applications and Flink Versions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-145" data-toggle="collapse"><i class="fa fa-bug title maindish" aria-hidden="true"></i> Debugging & Monitoring <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-145"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/metrics.html">Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/logging.html">Logging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/historyserver.html">History Server</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/checkpoint_monitoring.html">Monitoring Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/back_pressure.html">Monitoring Back Pressure</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/rest_api.html">Monitoring REST API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/debugging_event_time.html">Debugging Windows & Event Time</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/debugging_classloading.html">Debugging Classloading</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/application_profiling.html">Application Profiling</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-156" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> Internals <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-156"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/components.html">Component Stack</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/job_scheduling.html">Jobs and Scheduling</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/task_lifecycle.html">Task Lifecycle</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/filesystems.html">File Systems</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
  <li class="divider"></li>
  <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.4/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="/flink-docs/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
      
    </ul>
  </div>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">
          

          





  
  
    
    
      
    
  

  
  
    
    
      
    
  

  
  
    
    
      
    
  

  
  
    
    
      



<ol class="breadcrumb">

  
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</li>
  

  
  
    <li><a href="/flink-docs/dev/datastream_api.html">Streaming (DataStream API)</a></li>
  

  
  
    <li><a href="/flink-docs/dev/connectors/index.html">Connectors</a></li>
  

  
  
    <li class="active">Kinesis</li>
  

</ol>

<h1>Amazon AWS Kinesis Streams Connector</h1>




<ul id="markdown-toc">
  <li><a href="#using-the-amazon-kinesis-streams-service" id="markdown-toc-using-the-amazon-kinesis-streams-service">Using the Amazon Kinesis Streams Service</a></li>
  <li><a href="#kinesis-consumer" id="markdown-toc-kinesis-consumer">Kinesis Consumer</a>    <ul>
      <li><a href="#configuring-starting-position" id="markdown-toc-configuring-starting-position">Configuring Starting Position</a></li>
      <li><a href="#fault-tolerance-for-exactly-once-user-defined-state-update-semantics" id="markdown-toc-fault-tolerance-for-exactly-once-user-defined-state-update-semantics">Fault Tolerance for Exactly-Once User-Defined State Update Semantics</a></li>
      <li><a href="#event-time-for-consumed-records" id="markdown-toc-event-time-for-consumed-records">Event Time for Consumed Records</a></li>
      <li><a href="#threading-model" id="markdown-toc-threading-model">Threading Model</a></li>
      <li><a href="#internally-used-kinesis-apis" id="markdown-toc-internally-used-kinesis-apis">Internally Used Kinesis APIs</a></li>
    </ul>
  </li>
  <li><a href="#kinesis-producer" id="markdown-toc-kinesis-producer">Kinesis Producer</a></li>
  <li><a href="#using-non-aws-kinesis-endpoints-for-testing" id="markdown-toc-using-non-aws-kinesis-endpoints-for-testing">Using Non-AWS Kinesis Endpoints for Testing</a></li>
</ul>

<p>The Kinesis connector provides access to <a href="http://aws.amazon.com/kinesis/streams/">Amazon AWS Kinesis Streams</a>.</p>

<p>To use the connector, add the following Maven dependency to your project:</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.apache.flink<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>flink-connector-kinesis_2.10<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.4-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span></code></pre></div>

<p><strong>The <code>flink-connector-kinesis_2.10</code> has a dependency on code licensed under the <a href="https://aws.amazon.com/asl/">Amazon Software License</a> (ASL).
Linking to the flink-connector-kinesis will include ASL licensed code into your application.</strong></p>

<p>The <code>flink-connector-kinesis_2.10</code> artifact is not deployed to Maven central as part of
Flink releases because of the licensing issue. Therefore, you need to build the connector yourself from the source.</p>

<p>Download the Flink source or check it out from the git repository. Then, use the following Maven command to build the module:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mvn clean install -Pinclude-kinesis -DskipTests
<span class="c"># In Maven 3.3 the shading of flink-dist doesn&#39;t work properly in one run, so we need to run mvn for flink-dist again.</span>
<span class="nb">cd </span>flink-dist
mvn clean install -Pinclude-kinesis -DskipTests</code></pre></div>

<p>The streaming connectors are not part of the binary distribution. See how to link with them for cluster
execution <a href="/flink-docs/dev/linking.html">here</a>.</p>

<h2 id="using-the-amazon-kinesis-streams-service">Using the Amazon Kinesis Streams Service</h2>
<p>Follow the instructions from the <a href="https://docs.aws.amazon.com/streams/latest/dev/learning-kinesis-module-one-create-stream.html">Amazon Kinesis Streams Developer Guide</a>
to setup Kinesis streams. Make sure to create the appropriate IAM policy and user to read / write to the Kinesis streams.</p>

<h2 id="kinesis-consumer">Kinesis Consumer</h2>

<p>The <code>FlinkKinesisConsumer</code> is an exactly-once parallel streaming data source that subscribes to multiple AWS Kinesis
streams within the same AWS service region, and can transparently handle resharding of streams while the job is running. Each subtask of the consumer is
responsible for fetching data records from multiple Kinesis shards. The number of shards fetched by each subtask will
change as shards are closed and created by Kinesis.</p>

<p>Before consuming data from Kinesis streams, make sure that all streams are created with the status “ACTIVE” in the AWS dashboard.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Properties</span> <span class="n">consumerConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Properties</span><span class="o">();</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ConsumerConfigConstants</span><span class="o">.</span><span class="na">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ConsumerConfigConstants</span><span class="o">.</span><span class="na">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ConsumerConfigConstants</span><span class="o">.</span><span class="na">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ConsumerConfigConstants</span><span class="o">.</span><span class="na">STREAM_INITIAL_POSITION</span><span class="o">,</span> <span class="s">&quot;LATEST&quot;</span><span class="o">);</span>

<span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">kinesis</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">addSource</span><span class="o">(</span><span class="k">new</span> <span class="n">FlinkKinesisConsumer</span><span class="o">&lt;&gt;(</span>
    <span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">SimpleStringSchema</span><span class="o">(),</span> <span class="n">consumerConfig</span><span class="o">));</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">consumerConfig</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ConsumerConfigConstants</span><span class="o">.</span><span class="nc">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ConsumerConfigConstants</span><span class="o">.</span><span class="nc">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ConsumerConfigConstants</span><span class="o">.</span><span class="nc">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>
<span class="n">consumerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ConsumerConfigConstants</span><span class="o">.</span><span class="nc">STREAM_INITIAL_POSITION</span><span class="o">,</span> <span class="s">&quot;LATEST&quot;</span><span class="o">);</span>

<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getEnvironment</span>

<span class="k">val</span> <span class="n">kinesis</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">addSource</span><span class="o">(</span><span class="k">new</span> <span class="nc">FlinkKinesisConsumer</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span>
    <span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nc">SimpleStringSchema</span><span class="o">,</span> <span class="n">consumerConfig</span><span class="o">))</span></code></pre></div>

  </div>
</div>

<p>The above is a simple example of using the consumer. Configuration for the consumer is supplied with a <code>java.util.Properties</code>
instance, the configuration keys for which can be found in <code>ConsumerConfigConstants</code>. The example
demonstrates consuming a single Kinesis stream in the AWS region “us-east-1”. The AWS credentials are supplied using the basic method in which
the AWS access key ID and secret access key are directly supplied in the configuration (other options are setting
<code>ConsumerConfigConstants.AWS_CREDENTIALS_PROVIDER</code> to <code>ENV_VAR</code>, <code>SYS_PROP</code>, <code>PROFILE</code>, and <code>AUTO</code>). Also, data is being consumed
from the newest position in the Kinesis stream (the other option will be setting <code>ConsumerConfigConstants.STREAM_INITIAL_POSITION</code>
to <code>TRIM_HORIZON</code>, which lets the consumer start reading the Kinesis stream from the earliest record possible).</p>

<p>Other optional configuration keys for the consumer can be found in <code>ConsumerConfigConstants</code>.</p>

<p>Note that the configured parallelism of the Flink Kinesis Consumer source
can be completely independent of the total number of shards in the Kinesis streams.
When the number of shards is larger than the parallelism of the consumer,
then each consumer subtask can subscribe to multiple shards; otherwise
if the number of shards is smaller than the parallelism of the consumer,
then some consumer subtasks will simply be idle and wait until it gets assigned
new shards (i.e., when the streams are resharded to increase the
number of shards for higher provisioned Kinesis service throughput).</p>

<h3 id="configuring-starting-position">Configuring Starting Position</h3>

<p>The Flink Kinesis Consumer currently provides the following options to configure where to start reading Kinesis streams, simply by setting <code>ConsumerConfigConstants.STREAM_INITIAL_POSITION</code> to
one of the following values in the provided configuration properties (the naming of the options identically follows <a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/API_GetShardIterator.html#API_GetShardIterator_RequestSyntax">the namings used by the AWS Kinesis Streams service</a>):</p>

<ul>
  <li><code>LATEST</code>: read all shards of all streams starting from the latest record.</li>
  <li><code>TRIM_HORIZON</code>: read all shards of all streams starting from the earliest record possible (data may be trimmed by Kinesis depending on the retention settings).</li>
  <li><code>AT_TIMESTAMP</code>: read all shards of all streams starting from a specified timestamp. The timestamp must also be specified in the configuration
properties by providing a value for <code>ConsumerConfigConstants.STREAM_INITIAL_TIMESTAMP</code>, in one of the following date pattern :
    <ul>
      <li>a non-negative double value representing the number of seconds that has elapsed since the Unix epoch (for example, <code>1459799926.480</code>).</li>
      <li>a user defined pattern, which is a valid pattern for <code>SimpleDateFormat</code> provided by <code>ConsumerConfigConstants.STREAM_TIMESTAMP_DATE_FORMAT</code>.
  If <code>ConsumerConfigConstants.STREAM_TIMESTAMP_DATE_FORMAT</code> is not defined then the default pattern will be <code>yyyy-MM-dd'T'HH:mm:ss.SSSXXX</code>
  (for example, timestamp value is <code>2016-04-04</code> and pattern is <code>yyyy-MM-dd</code> given by user or timestamp value is <code>2016-04-04T19:58:46.480-00:00</code> without given a pattern).</li>
    </ul>
  </li>
</ul>

<h3 id="fault-tolerance-for-exactly-once-user-defined-state-update-semantics">Fault Tolerance for Exactly-Once User-Defined State Update Semantics</h3>

<p>With Flink’s checkpointing enabled, the Flink Kinesis Consumer will consume records from shards in Kinesis streams and
periodically checkpoint each shard’s progress. In case of a job failure, Flink will restore the streaming program to the
state of the latest complete checkpoint and re-consume the records from Kinesis shards, starting from the progress that
was stored in the checkpoint.</p>

<p>The interval of drawing checkpoints therefore defines how much the program may have to go back at most, in case of a failure.</p>

<p>To use fault tolerant Kinesis Consumers, checkpointing of the topology needs to be enabled at the execution environment:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">env</span><span class="o">.</span><span class="na">enableCheckpointing</span><span class="o">(</span><span class="mi">5000</span><span class="o">);</span> <span class="c1">// checkpoint every 5000 msecs</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span><span class="o">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">enableCheckpointing</span><span class="o">(</span><span class="mi">5000</span><span class="o">)</span> <span class="c1">// checkpoint every 5000 msecs</span></code></pre></div>

  </div>
</div>

<p>Also note that Flink can only restart the topology if enough processing slots are available to restart the topology.
Therefore, if the topology fails due to loss of a TaskManager, there must still be enough slots available afterwards.
Flink on YARN supports automatic restart of lost YARN containers.</p>

<h3 id="event-time-for-consumed-records">Event Time for Consumed Records</h3>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">final</span> <span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">env</span><span class="o">.</span><span class="na">setStreamTimeCharacteristic</span><span class="o">(</span><span class="n">TimeCharacteristic</span><span class="o">.</span><span class="na">EventTime</span><span class="o">);</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span><span class="o">()</span>
<span class="n">env</span><span class="o">.</span><span class="n">setStreamTimeCharacteristic</span><span class="o">(</span><span class="nc">TimeCharacteristic</span><span class="o">.</span><span class="nc">EventTime</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p>If streaming topologies choose to use the <a href="/flink-docs/apis/streaming/event_time.html">event time notion</a> for record
timestamps, an <em>approximate arrival timestamp</em> will be used by default. This timestamp is attached to records by Kinesis once they
were successfully received and stored by streams. Note that this timestamp is typically referred to as a Kinesis server-side
timestamp, and there are no guarantees about the accuracy or order correctness (i.e., the timestamps may not always be
ascending).</p>

<p>Users can choose to override this default with a custom timestamp, as described <a href="/flink-docs/apis/streaming/event_timestamps_watermarks.html">here</a>,
or use one from the <a href="/flink-docs/apis/streaming/event_timestamp_extractors.html">predefined ones</a>. After doing so,
it can be passed to the consumer in the following way:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">DataStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">kinesis</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">addSource</span><span class="o">(</span><span class="k">new</span> <span class="n">FlinkKinesisConsumer</span><span class="o">&lt;&gt;(</span>
    <span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">SimpleStringSchema</span><span class="o">(),</span> <span class="n">kinesisConsumerConfig</span><span class="o">));</span>
<span class="n">kinesis</span> <span class="o">=</span> <span class="n">kinesis</span><span class="o">.</span><span class="na">assignTimestampsAndWatermarks</span><span class="o">(</span><span class="k">new</span> <span class="nf">CustomTimestampAssigner</span><span class="o">());</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">kinesis</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">addSource</span><span class="o">(</span><span class="k">new</span> <span class="nc">FlinkKinesisConsumer</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span>
    <span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nc">SimpleStringSchema</span><span class="o">,</span> <span class="n">kinesisConsumerConfig</span><span class="o">))</span>
<span class="n">kinesis</span> <span class="k">=</span> <span class="n">kinesis</span><span class="o">.</span><span class="n">assignTimestampsAndWatermarks</span><span class="o">(</span><span class="k">new</span> <span class="nc">CustomTimestampAssigner</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<h3 id="threading-model">Threading Model</h3>

<p>The Flink Kinesis Consumer uses multiple threads for shard discovery and data consumption.</p>

<p>For shard discovery, each parallel consumer subtask will have a single thread that constantly queries Kinesis for shard
information even if the subtask initially did not have shards to read from when the consumer was started. In other words, if
the consumer is run with a parallelism of 10, there will be a total of 10 threads constantly querying Kinesis regardless
of the total amount of shards in the subscribed streams.</p>

<p>For data consumption, a single thread will be created to consume each discovered shard. Threads will terminate when the
shard it is responsible of consuming is closed as a result of stream resharding. In other words, there will always be
one thread per open shard.</p>

<h3 id="internally-used-kinesis-apis">Internally Used Kinesis APIs</h3>

<p>The Flink Kinesis Consumer uses the <a href="http://aws.amazon.com/sdk-for-java/">AWS Java SDK</a> internally to call Kinesis APIs
for shard discovery and data consumption. Due to Amazon’s <a href="http://docs.aws.amazon.com/streams/latest/dev/service-sizes-and-limits.html">service limits for Kinesis Streams</a>
on the APIs, the consumer will be competing with other non-Flink consuming applications that the user may be running.
Below is a list of APIs called by the consumer with description of how the consumer uses the API, as well as information
on how to deal with any errors or warnings that the Flink Kinesis Consumer may have due to these service limits.</p>

<ul>
  <li>
    <p><em><a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/API_DescribeStream.html">DescribeStream</a></em>: this is constantly called
by a single thread in each parallel consumer subtask to discover any new shards as a result of stream resharding. By default,
the consumer performs the shard discovery at an interval of 10 seconds, and will retry indefinitely until it gets a result
from Kinesis. If this interferes with other non-Flink consuming applications, users can slow down the consumer of
calling this API by setting a value for <code>ConsumerConfigConstants.SHARD_DISCOVERY_INTERVAL_MILLIS</code> in the supplied
configuration properties. This sets the discovery interval to a different value. Note that this setting directly impacts
the maximum delay of discovering a new shard and starting to consume it, as shards will not be discovered during the interval.</p>
  </li>
  <li>
    <p><em><a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/API_GetShardIterator.html">GetShardIterator</a></em>: this is called
only once when per shard consuming threads are started, and will retry if Kinesis complains that the transaction limit for the
API has exceeded, up to a default of 3 attempts. Note that since the rate limit for this API is per shard (not per stream),
the consumer itself should not exceed the limit. Usually, if this happens, users can either try to slow down any other
non-Flink consuming applications of calling this API, or modify the retry behaviour of this API call in the consumer by
setting keys prefixed by <code>ConsumerConfigConstants.SHARD_GETITERATOR_*</code> in the supplied configuration properties.</p>
  </li>
  <li>
    <p><em><a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/API_GetRecords.html">GetRecords</a></em>: this is constantly called
by per shard consuming threads to fetch records from Kinesis. When a shard has multiple concurrent consumers (when there
are any other non-Flink consuming applications running), the per shard rate limit may be exceeded. By default, on each call
of this API, the consumer will retry if Kinesis complains that the data size / transaction limit for the API has exceeded,
up to a default of 3 attempts. Users can either try to slow down other non-Flink consuming applications, or adjust the throughput
of the consumer by setting the <code>ConsumerConfigConstants.SHARD_GETRECORDS_MAX</code> and
<code>ConsumerConfigConstants.SHARD_GETRECORDS_INTERVAL_MILLIS</code> keys in the supplied configuration properties. Setting the former
adjusts the maximum number of records each consuming thread tries to fetch from shards on each call (default is 10,000), while
the latter modifies the sleep interval between each fetch (default is 200). The retry behaviour of the
consumer when calling this API can also be modified by using the other keys prefixed by <code>ConsumerConfigConstants.SHARD_GETRECORDS_*</code>.</p>
  </li>
</ul>

<h2 id="kinesis-producer">Kinesis Producer</h2>

<p>The <code>FlinkKinesisProducer</code> is used for putting data from a Flink stream into a Kinesis stream. Note that the producer is not participating in
Flink’s checkpointing and doesn’t provide exactly-once processing guarantees.
Also, the Kinesis producer does not guarantee that records are written in order to the shards (See <a href="https://github.com/awslabs/amazon-kinesis-producer/issues/23">here</a> and <a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/API_PutRecord.html#API_PutRecord_RequestSyntax">here</a> for more details).</p>

<p>In case of a failure or a resharding, data will be written again to Kinesis, leading to duplicates. This behavior is usually called “at-least-once” semantics.</p>

<p>To put data into a Kinesis stream, make sure the stream is marked as “ACTIVE” in the AWS dashboard.</p>

<p>For the monitoring to work, the user accessing the stream needs access to the Cloud watch service.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Properties</span> <span class="n">producerConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Properties</span><span class="o">();</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>

<span class="n">FlinkKinesisProducer</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">kinesis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FlinkKinesisProducer</span><span class="o">&lt;&gt;(</span><span class="k">new</span> <span class="nf">SimpleStringSchema</span><span class="o">(),</span> <span class="n">producerConfig</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="na">setFailOnError</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="na">setDefaultStream</span><span class="o">(</span><span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="na">setDefaultPartition</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">simpleStringStream</span> <span class="o">=</span> <span class="o">...;</span>
<span class="n">simpleStringStream</span><span class="o">.</span><span class="na">addSink</span><span class="o">(</span><span class="n">kinesis</span><span class="o">);</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">producerConfig</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>

<span class="k">val</span> <span class="n">kinesis</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">FlinkKinesisProducer</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="k">new</span> <span class="nc">SimpleStringSchema</span><span class="o">,</span> <span class="n">producerConfig</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="n">setFailOnError</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="n">setDefaultStream</span><span class="o">(</span><span class="s">&quot;kinesis_stream_name&quot;</span><span class="o">);</span>
<span class="n">kinesis</span><span class="o">.</span><span class="n">setDefaultPartition</span><span class="o">(</span><span class="s">&quot;0&quot;</span><span class="o">);</span>

<span class="k">val</span> <span class="n">simpleStringStream</span> <span class="k">=</span> <span class="o">...;</span>
<span class="n">simpleStringStream</span><span class="o">.</span><span class="n">addSink</span><span class="o">(</span><span class="n">kinesis</span><span class="o">);</span></code></pre></div>

  </div>
</div>

<p>The above is a simple example of using the producer. Configuration for the producer with the mandatory configuration values is supplied with a <code>java.util.Properties</code>
instance as described above for the consumer. The example demonstrates producing a single Kinesis stream in the AWS region “us-east-1”.</p>

<p>Instead of a <code>SerializationSchema</code>, it also supports a <code>KinesisSerializationSchema</code>. The <code>KinesisSerializationSchema</code> allows to send the data to multiple streams. This is
done using the <code>KinesisSerializationSchema.getTargetStream(T element)</code> method. Returning <code>null</code> there will instruct the producer to write the element to the default stream.
Otherwise, the returned stream name is used.</p>

<p>Other optional configuration keys for the producer can be found in <code>ProducerConfigConstants</code>.</p>

<h2 id="using-non-aws-kinesis-endpoints-for-testing">Using Non-AWS Kinesis Endpoints for Testing</h2>

<p>It is sometimes desirable to have Flink operate as a consumer or producer against a non-AWS Kinesis endpoint such as
<a href="https://github.com/mhart/kinesalite">Kinesalite</a>; this is especially useful when performing functional testing of a Flink
application. The AWS endpoint that would normally be inferred by the AWS region set in the Flink configuration must be overridden via a configuration property.</p>

<p>To override the AWS endpoint, taking the producer for example, set the <code>ProducerConfigConstants.AWS_ENDPOINT</code> property in the
Flink configuration, in addition to the <code>ProducerConfigConstants.AWS_REGION</code> required by Flink. Although the region is
required, it will not be used to determine the AWS endpoint URL.</p>

<p>The following example shows how one might supply the <code>ProducerConfigConstants.AWS_ENDPOINT</code> configuration property:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">Properties</span> <span class="n">producerConfig</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Properties</span><span class="o">();</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ProducerConfigConstants</span><span class="o">.</span><span class="na">AWS_ENDPOINT</span><span class="o">,</span> <span class="s">&quot;http://localhost:4567&quot;</span><span class="o">);</span></code></pre></div>

  </div>
  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">producerConfig</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Properties</span><span class="o">();</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_REGION</span><span class="o">,</span> <span class="s">&quot;us-east-1&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_ACCESS_KEY_ID</span><span class="o">,</span> <span class="s">&quot;aws_access_key_id&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_SECRET_ACCESS_KEY</span><span class="o">,</span> <span class="s">&quot;aws_secret_access_key&quot;</span><span class="o">);</span>
<span class="n">producerConfig</span><span class="o">.</span><span class="n">put</span><span class="o">(</span><span class="nc">ProducerConfigConstants</span><span class="o">.</span><span class="nc">AWS_ENDPOINT</span><span class="o">,</span> <span class="s">&quot;http://localhost:4567&quot;</span><span class="o">);</span></code></pre></div>

  </div>
</div>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="/flink-docs/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
