<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.4-SNAPSHOT Documentation: Concepts & Common API</title>
    <link rel="shortcut icon" href="/flink-docs/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/flink-docs/page/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="/flink-docs/page/css/flink.css">
    <link rel="stylesheet" href="/flink-docs/page/css/syntax.css">
    <link rel="stylesheet" href="/flink-docs/page/css/codetabs.css">
    <link rel="stylesheet" href="/flink-docs/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          







  
    
    
    
      
    
  

  
    
    
    
      
    
  

  
    
    
    
      









  





<div class="sidenav-logo">
  <p><a href="/flink-docs"><img class="bottom" alt="Apache Flink" src="/flink-docs/page/img/navbar-brand-logo.jpg"></a> v1.4-SNAPSHOT</p>
</div>
<ul id="sidenav">

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/index.html"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li>
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/concepts/programming-model.html">Programming Model</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/concepts/runtime.html">Distributed Runtime</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/setup_quickstart.html"><i class="fa fa-power-off title appetizer" aria-hidden="true"></i> Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-7" data-toggle="collapse"><i class="fa fa-file-code-o title appetizer" aria-hidden="true"></i> Examples <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-7"><ul>
  <li><a href="/flink-docs/examples/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/run_example_quickstart.html">Monitoring Wikipedia Edits</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/examples.html">Batch Examples</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-11" data-toggle="collapse"><i class="fa fa-book title appetizer" aria-hidden="true"></i> Cookbooks <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-11"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/cookbooks/join-streams.html">Join Streams</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/cookbooks/pattern-detection.html">Pattern Detection with CEP</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Project Setup <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/java_api_quickstart.html">Sample Project in Java</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/quickstart/scala_api_quickstart.html">Sample Project in Scala</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/linking_with_flink.html">Linking with Flink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/ide_setup.html">IDE Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/scala_shell.html">Scala REPL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/linking.html">Linking with Optional Modules</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/start/flink_on_windows.html">Running Flink on Windows</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/start/building.html">Building Flink from Source</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-25" data-toggle="collapse" class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</a><div class="collapse in" id="collapse-25"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-26" data-toggle="collapse">Basic API Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-26"><ul>
  <li><a href="/flink-docs/dev/api_concepts.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/scala_api_extensions.html">Scala API Extensions</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/java8.html">Java 8</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-30" data-toggle="collapse">Streaming (DataStream API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-30"><ul>
  <li><a href="/flink-docs/dev/datastream_api.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-31" data-toggle="collapse">Event Time <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-31"><ul>
  <li><a href="/flink-docs/dev/event_time.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/event_timestamps_watermarks.html">Generating Timestamps / Watermarks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/event_timestamp_extractors.html">Pre-defined Timestamp Extractors / Watermark Emitters</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-35" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-35"><ul>
  <li><a href="/flink-docs/dev/stream/state/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/state.html">Working with State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/checkpointing.html">Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/queryable_state.html">Queryable State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/state/custom_serialization.html">Custom Serialization</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-42" data-toggle="collapse">Operators <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-42"><ul>
  <li><a href="/flink-docs/dev/stream/operators/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/dev/stream/operators/windows.html">Windows</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/operators/process_function.html">Process Function</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/operators/asyncio.html">Async I/O</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-47" data-toggle="collapse">Connectors <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-47"><ul>
  <li><a href="/flink-docs/dev/connectors/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/guarantees.html">Fault Tolerance Guarantees</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/kafka.html">Kafka</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/cassandra.html">Cassandra</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/kinesis.html">Kinesis</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/filesystem_sink.html">Rolling File Sink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/nifi.html">NiFi</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/connectors/twitter.html">Twitter</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/stream/side_output.html">Side Outputs</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/dev/stream/testing.html">Testing</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-61" data-toggle="collapse">Batch (DataSet API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-61"><ul>
  <li><a href="/flink-docs/dev/batch/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/dataset_transformations.html">Transformations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/iterations.html">Iterations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/fault_tolerance.html">Fault Tolerance</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/python.html">Python API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/connectors.html">Connectors</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/batch/hadoop_compatibility.html">Hadoop Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/local_execution.html">Local Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/cluster_execution.html">Cluster Execution</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-72" data-toggle="collapse" class="active">Table API & SQL</a><div class="collapse in" id="collapse-72"><ul>
  <li><a href="/flink-docs/dev/table/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/common.html" class="active">Concepts & Common API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/streaming.html">Streaming Concepts</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/tableApi.html">Table API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/sql.html">SQL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/sourceSinks.html">Table Sources & Sinks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/table/udfs.html">User-defined Functions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-80" data-toggle="collapse">Data Types & Serialization <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-80"><ul>
  <li><a href="/flink-docs/dev/types_serialization.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/custom_serializers.html">Custom Serializers</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-83" data-toggle="collapse">Managing Execution <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-83"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/execution_configuration.html">Execution Configuration</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/packaging.html">Program Packaging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/parallel.html">Parallel Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/execution_plans.html">Execution Plans</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/restart_strategies.html">Restart Strategies</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-90" data-toggle="collapse">Libraries <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-90"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/cep.html">Event Processing (CEP)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/storm_compatibility.html">Storm Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-93" data-toggle="collapse">Graphs: Gelly <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-93"><ul>
  <li><a href="/flink-docs/dev/libs/gelly/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_api.html">Graph API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/library_methods.html">Library Methods</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-101" data-toggle="collapse">Machine Learning <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-101"><ul>
  <li><a href="/flink-docs/dev/libs/ml/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/quickstart.html">Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/multiple_linear_regression.html">Multiple Linear Regression</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/cross_validation.html">Cross Validation</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/distance_metrics.html">Distance Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/knn.html">k-Nearest Neighbors Join</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/min_max_scaler.html">MinMax Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/contribution_guide.html">How to Contribute</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/pipelines.html">Pipelines</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/polynomial_features.html">Polynomial Features</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/als.html">ALS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/sos.html">Stochastic Outlier Selection</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/standard_scaler.html">Standard Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/libs/ml/svm.html">SVM using CoCoA</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/best_practices.html">Best Practices</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/dev/migration.html">API Migration Guides</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-120" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment & Operations <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-121" data-toggle="collapse">Clusters & Deployment <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-121"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/cluster_setup.html">Standalone Cluster</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/yarn_setup.html">YARN</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/mesos.html">Mesos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/docker.html">Docker</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/kubernetes.html">Kubernetes</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/aws.html">AWS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/gce_setup.html">Google Compute Engine</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/deployment/mapr_setup.html">MapR</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/jobmanager_high_availability.html">High Availability (HA)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-132" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/checkpoints.html">Checkpoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/savepoints.html">Savepoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="/flink-docs/ops/config.html">Configuration</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/production_ready.html">Production Readiness Checklist</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/cli.html">CLI</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/security-kerberos.html">Kerberos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/security-ssl.html">SSL Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/ops/upgrading.html">Upgrading Applications and Flink Versions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-145" data-toggle="collapse"><i class="fa fa-bug title maindish" aria-hidden="true"></i> Debugging & Monitoring <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-145"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/metrics.html">Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/logging.html">Logging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/historyserver.html">History Server</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/checkpoint_monitoring.html">Monitoring Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/back_pressure.html">Monitoring Back Pressure</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/rest_api.html">Monitoring REST API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/debugging_event_time.html">Debugging Windows & Event Time</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/debugging_classloading.html">Debugging Classloading</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/monitoring/application_profiling.html">Application Profiling</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-156" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> Internals <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-156"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/components.html">Component Stack</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/job_scheduling.html">Jobs and Scheduling</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/task_lifecycle.html">Task Lifecycle</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="/flink-docs/internals/filesystems.html">File Systems</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
  <li class="divider"></li>
  <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.4/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="/flink-docs/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
      
    </ul>
  </div>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">
          

          





  
  
    
    
      
    
  

  
  
    
    
      
    
  

  
  
    
    
      



<ol class="breadcrumb">

  
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</li>
  

  
  
    <li><a href="/flink-docs/dev/table/index.html">Table API & SQL</a></li>
  

  
  
    <li class="active">Concepts & Common API</li>
  

</ol>

<h1>Concepts & Common API</h1>




<p>The Table API and SQL are integrated in a joint API. The central concept of this API is a <code>Table</code> which serves as input and output of queries. This document shows the common structure of programs with Table API and SQL queries, how to register a <code>Table</code>, how to query a <code>Table</code>, and how to emit a <code>Table</code>.</p>

<ul id="markdown-toc">
  <li><a href="#structure-of-table-api-and-sql-programs" id="markdown-toc-structure-of-table-api-and-sql-programs">Structure of Table API and SQL Programs</a></li>
  <li><a href="#create-a-tableenvironment" id="markdown-toc-create-a-tableenvironment">Create a TableEnvironment</a></li>
  <li><a href="#register-a-table-in-the-catalog" id="markdown-toc-register-a-table-in-the-catalog">Register a Table in the Catalog</a>    <ul>
      <li><a href="#register-a-table" id="markdown-toc-register-a-table">Register a Table</a></li>
      <li><a href="#register-a-tablesource" id="markdown-toc-register-a-tablesource">Register a TableSource</a></li>
    </ul>
  </li>
  <li><a href="#register-an-external-catalog" id="markdown-toc-register-an-external-catalog">Register an External Catalog</a></li>
  <li><a href="#query-a-table" id="markdown-toc-query-a-table">Query a Table</a>    <ul>
      <li><a href="#table-api" id="markdown-toc-table-api">Table API</a></li>
      <li><a href="#sql" id="markdown-toc-sql">SQL</a></li>
      <li><a href="#mixing-table-api-and-sql" id="markdown-toc-mixing-table-api-and-sql">Mixing Table API and SQL</a></li>
    </ul>
  </li>
  <li><a href="#emit-a-table" id="markdown-toc-emit-a-table">Emit a Table</a></li>
  <li><a href="#translate-and-execute-a-query" id="markdown-toc-translate-and-execute-a-query">Translate and Execute a Query</a></li>
  <li><a href="#integration-with-datastream-and-dataset-api" id="markdown-toc-integration-with-datastream-and-dataset-api">Integration with DataStream and DataSet API</a>    <ul>
      <li><a href="#implicit-conversion-for-scala" id="markdown-toc-implicit-conversion-for-scala">Implicit Conversion for Scala</a></li>
      <li><a href="#register-a-datastream-or-dataset-as-table" id="markdown-toc-register-a-datastream-or-dataset-as-table">Register a DataStream or DataSet as Table</a></li>
      <li><a href="#convert-a-datastream-or-dataset-into-a-table" id="markdown-toc-convert-a-datastream-or-dataset-into-a-table">Convert a DataStream or DataSet into a Table</a></li>
      <li><a href="#convert-a-table-into-a-datastream-or-dataset" id="markdown-toc-convert-a-table-into-a-datastream-or-dataset">Convert a Table into a DataStream or DataSet</a></li>
      <li><a href="#mapping-of-data-types-to-table-schema" id="markdown-toc-mapping-of-data-types-to-table-schema">Mapping of Data Types to Table Schema</a></li>
    </ul>
  </li>
  <li><a href="#query-optimization" id="markdown-toc-query-optimization">Query Optimization</a>    <ul>
      <li><a href="#explaining-a-table" id="markdown-toc-explaining-a-table">Explaining a Table</a></li>
    </ul>
  </li>
</ul>

<h2 id="structure-of-table-api-and-sql-programs">Structure of Table API and SQL Programs</h2>

<p>All Table API and SQL programs for batch and streaming follow the same pattern. The following code example shows the common structure of Table API and SQL programs.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// for batch programs use ExecutionEnvironment instead of StreamExecutionEnvironment</span>
<span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>

<span class="c1">// create a TableEnvironment</span>
<span class="c1">// for batch programs use BatchTableEnvironment instead of StreamTableEnvironment</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register a Table</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTable</span><span class="o">(</span><span class="s">&quot;table1&quot;</span><span class="o">,</span> <span class="o">...)</span>            <span class="c1">// or</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSource</span><span class="o">(</span><span class="s">&quot;table2&quot;</span><span class="o">,</span> <span class="o">...);</span>     <span class="c1">// or</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerExternalCatalog</span><span class="o">(</span><span class="s">&quot;extCat&quot;</span><span class="o">,</span> <span class="o">...);</span>

<span class="c1">// create a Table from a Table API query</span>
<span class="n">Table</span> <span class="n">tapiResult</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="s">&quot;table1&quot;</span><span class="o">).</span><span class="na">select</span><span class="o">(...);</span>
<span class="c1">// create a Table from a SQL query</span>
<span class="n">Table</span> <span class="n">sqlResult</span>  <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT ... FROM table2 ... &quot;</span><span class="o">);</span>

<span class="c1">// emit a Table API result Table to a TableSink, same for SQL result</span>
<span class="n">tapiResult</span><span class="o">.</span><span class="na">writeToSink</span><span class="o">(...);</span>

<span class="c1">// execute</span>
<span class="n">env</span><span class="o">.</span><span class="na">execute</span><span class="o">();</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// for batch programs use ExecutionEnvironment instead of StreamExecutionEnvironment</span>
<span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>

<span class="c1">// create a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register a Table</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTable</span><span class="o">(</span><span class="s">&quot;table1&quot;</span><span class="o">,</span> <span class="o">...)</span>           <span class="c1">// or</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSource</span><span class="o">(</span><span class="s">&quot;table2&quot;</span><span class="o">,</span> <span class="o">...)</span>     <span class="c1">// or</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerExternalCatalog</span><span class="o">(</span><span class="s">&quot;extCat&quot;</span><span class="o">,</span> <span class="o">...)</span> 

<span class="c1">// create a Table from a Table API query</span>
<span class="k">val</span> <span class="n">tapiResult</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">scan</span><span class="o">(</span><span class="s">&quot;table1&quot;</span><span class="o">).</span><span class="n">select</span><span class="o">(...)</span>
<span class="c1">// Create a Table from a SQL query</span>
<span class="k">val</span> <span class="n">sqlResult</span>  <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT ... FROM table2 ...&quot;</span><span class="o">)</span>

<span class="c1">// emit a Table API result Table to a TableSink, same for SQL result</span>
<span class="n">tapiResult</span><span class="o">.</span><span class="n">writeToSink</span><span class="o">(...)</span>

<span class="c1">// execute</span>
<span class="n">env</span><span class="o">.</span><span class="n">execute</span><span class="o">()</span></code></pre></div>

  </div>
</div>

<p><strong>Note:</strong> Table API and SQL queries can be easily integrated with and embedded into DataStream or DataSet programs. Have a look at the <a href="#integration-with-datastream-and-dataset-api">Integration with DataStream and DataSet API</a> section to learn how DataStreams and DataSets can be converted into Tables and vice versa.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="create-a-tableenvironment">Create a TableEnvironment</h2>

<p>The <code>TableEnvironment</code> is a central concept of the Table API and SQL integration. It is responsible for:</p>

<ul>
  <li>Registering a <code>Table</code> in the internal catalog</li>
  <li>Registering an external catalog</li>
  <li>Executing SQL queries</li>
  <li>Registering a user-defined (scalar, table, or aggregation) function</li>
  <li>Converting a <code>DataStream</code> or <code>DataSet</code> into a <code>Table</code></li>
  <li>Holding a reference to an <code>ExecutionEnvironment</code> or <code>StreamExecutionEnvironment</code></li>
</ul>

<p>A <code>Table</code> is always bound to a specific <code>TableEnvironment</code>. It is not possible to combine tables of different TableEnvironments in the same query, e.g., to join or union them.</p>

<p>A <code>TableEnvironment</code> is created by calling the static <code>TableEnvironment.getTableEnvironment()</code> method with a <code>StreamExecutionEnvironment</code> or an <code>ExecutionEnvironment</code> and an optional <code>TableConfig</code>. The <code>TableConfig</code> can be used to configure the <code>TableEnvironment</code> or to customize the query optimization and translation process (see <a href="#query-optimization">Query Optimization</a>).</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// ***************</span>
<span class="c1">// STREAMING QUERY</span>
<span class="c1">// ***************</span>
<span class="n">StreamExecutionEnvironment</span> <span class="n">sEnv</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="c1">// create a TableEnvironment for streaming queries</span>
<span class="n">StreamTableEnvironment</span> <span class="n">sTableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">sEnv</span><span class="o">);</span>

<span class="c1">// ***********</span>
<span class="c1">// BATCH QUERY</span>
<span class="c1">// ***********</span>
<span class="n">ExecutionEnvironment</span> <span class="n">bEnv</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="c1">// create a TableEnvironment for batch queries</span>
<span class="n">BatchTableEnvironment</span> <span class="n">bTableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">bEnv</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// ***************</span>
<span class="c1">// STREAMING QUERY</span>
<span class="c1">// ***************</span>
<span class="k">val</span> <span class="n">sEnv</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="c1">// create a TableEnvironment for streaming queries</span>
<span class="k">val</span> <span class="n">sTableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">sEnv</span><span class="o">)</span>

<span class="c1">// ***********</span>
<span class="c1">// BATCH QUERY</span>
<span class="c1">// ***********</span>
<span class="k">val</span> <span class="n">bEnv</span> <span class="k">=</span> <span class="nc">ExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="c1">// create a TableEnvironment for batch queries</span>
<span class="k">val</span> <span class="n">bTableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">bEnv</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="register-a-table-in-the-catalog">Register a Table in the Catalog</h2>

<p>A <code>TableEnvironment</code> has an internal catalog of tables, organized by table name. Table API or SQL queries can access tables which are registered in the catalog, by referencing them by name.</p>

<p>A <code>TableEnvironment</code> allows you to register a table from various sources:</p>

<ul>
  <li>an existing <code>Table</code> object, usually the result of a Table API or SQL query.</li>
  <li>a <code>TableSource</code>, which accesses external data, such as a file, database, or messaging system.</li>
  <li>a <code>DataStream</code> or <code>DataSet</code> from a DataStream or DataSet program.</li>
</ul>

<p>Registering a <code>DataStream</code> or <code>DataSet</code> as a table is discussed in the <a href="#integration-with-datastream-and-dataset-api">Integration with DataStream and DataSet API</a> section.</p>

<h3 id="register-a-table">Register a Table</h3>

<p>A <code>Table</code> is registered in a <code>TableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// Table is the result of a simple projection query </span>
<span class="n">Table</span> <span class="n">projTable</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="s">&quot;X&quot;</span><span class="o">).</span><span class="na">project</span><span class="o">(...);</span>

<span class="c1">// register the Table projTable as table &quot;projectedX&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTable</span><span class="o">(</span><span class="s">&quot;projectedTable&quot;</span><span class="o">,</span> <span class="n">projTable</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// Table is the result of a simple projection query </span>
<span class="k">val</span> <span class="n">projTable</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">scan</span><span class="o">(</span><span class="s">&quot;X&quot;</span><span class="o">).</span><span class="n">project</span><span class="o">(...)</span>

<span class="c1">// register the Table projTable as table &quot;projectedX&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTable</span><span class="o">(</span><span class="s">&quot;projectedTable&quot;</span><span class="o">,</span> <span class="n">projTable</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><strong>Note:</strong> A registered <code>Table</code> is treated similarly to a <code>VIEW</code> as known from relational database systems, i.e., the query that defines the <code>Table</code> is not optimized but will be inlined when another query references the registered <code>Table</code>. If multiple queries reference the same registered <code>Table</code>, it will be inlined for each referencing query and executed multiple times, i.e., the result of the registered <code>Table</code> will <em>not</em> be shared.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="register-a-tablesource">Register a TableSource</h3>

<p>A <code>TableSource</code> provides access to external data which is stored in a storage systems such as a database (MySQL, HBase, …), a file with specific encoding (CSV, Apache [Parquet, Avro, ORC], …), or a messaging system (Apache Kafka, RabbitMQ, …).</p>

<p>Flink aims to provide TableSources for common data formats and storage systems. Please have a look at the <a href="/flink-docs/dev/table/sourceSinks.html">Table Sources and Sinks</a> page for a list of supported TableSources and instructions for how to build a custom <code>TableSource</code>.</p>

<p>A <code>TableSource</code> is registered in a <code>TableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// create a TableSource</span>
<span class="n">TableSource</span> <span class="n">csvSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">CsvTableSource</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="o">...);</span>

<span class="c1">// register the TableSource as table &quot;CsvTable&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSource</span><span class="o">(</span><span class="s">&quot;CsvTable&quot;</span><span class="o">,</span> <span class="n">csvSource</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// create a TableSource</span>
<span class="k">val</span> <span class="n">csvSource</span><span class="k">:</span> <span class="kt">TableSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvTableSource</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="o">...)</span>

<span class="c1">// register the TableSource as table &quot;CsvTable&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSource</span><span class="o">(</span><span class="s">&quot;CsvTable&quot;</span><span class="o">,</span> <span class="n">csvSource</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="register-an-external-catalog">Register an External Catalog</h2>

<p>An external catalog can provide information about external databases and tables such as their name, schema, statistics, and information for how to access data stored in an external database, table, or file.</p>

<p>An external catalog can be created by implementing the <code>ExternalCatalog</code> interface and is registered in a <code>TableEnvironment</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// create an external catalog</span>
<span class="n">ExternalCatalog</span> <span class="n">catalog</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">InMemoryExternalCatalog</span><span class="o">();</span>

<span class="c1">// register the ExternalCatalog catalog</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerExternalCatalog</span><span class="o">(</span><span class="s">&quot;InMemCatalog&quot;</span><span class="o">,</span> <span class="n">catalog</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// create an external catalog</span>
<span class="k">val</span> <span class="n">catalog</span><span class="k">:</span> <span class="kt">ExternalCatalog</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">InMemoryExternalCatalog</span>

<span class="c1">// register the ExternalCatalog catalog</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerExternalCatalog</span><span class="o">(</span><span class="s">&quot;InMemCatalog&quot;</span><span class="o">,</span> <span class="n">catalog</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p>Once registered in a <code>TableEnvironment</code>, all tables defined in a <code>ExternalCatalog</code> can be accessed from Table API or SQL queries by specifying their full path, such as <code>catalog.database.table</code>.</p>

<p>Currently, Flink provides an <code>InMemoryExternalCatalog</code> for demo and testing purposes. However, the <code>ExternalCatalog</code> interface can also be used to connect catalogs like HCatalog or Metastore to the Table API.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="query-a-table">Query a Table</h2>

<h3 id="table-api">Table API</h3>

<p>The Table API is a language-integrated query API for Scala and Java. In contrast to SQL, queries are not specified as Strings but are composed step-by-step in the host language.</p>

<p>The API is based on the <code>Table</code> class which represents a table (streaming or batch) and offers methods to apply relational operations. These methods return a new <code>Table</code> object, which represents the result of applying the relational operation on the input <code>Table</code>. Some relational operations are composed of multiple method calls such as <code>table.groupBy(...).select()</code>, where <code>groupBy(...)</code> specifies a grouping of <code>table</code>, and <code>select(...)</code> the projection on the grouping of <code>table</code>.</p>

<p>The <a href="/flink-docs/dev/table/tableapi.html">Table API</a> document describes all Table API operations that are supported on streaming and batch tables.</p>

<p>The following example shows a simple Table API aggregation query:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register Orders table</span>

<span class="c1">// scan registered Orders table</span>
<span class="n">Table</span> <span class="n">orders</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">scan</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">);</span>
<span class="c1">// compute revenue for all customers from France</span>
<span class="n">Table</span> <span class="n">revenue</span> <span class="o">=</span> <span class="n">orders</span>
  <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="s">&quot;cCountry === &#39;FRANCE&#39;&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">groupBy</span><span class="o">(</span><span class="s">&quot;cID, cName&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;cID, cName, revenue.sum AS revSum&quot;</span><span class="o">);</span>

<span class="c1">// emit or convert Table</span>
<span class="c1">// execute query</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register Orders table</span>

<span class="c1">// scan registered Orders table</span>
<span class="nc">Table</span> <span class="n">orders</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">scan</span><span class="o">(</span><span class="s">&quot;Orders&quot;</span><span class="o">)</span>
<span class="c1">// compute revenue for all customers from France</span>
<span class="nc">Table</span> <span class="n">revenue</span> <span class="k">=</span> <span class="n">orders</span>
  <span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="-Symbol">&#39;cCountry</span> <span class="o">===</span> <span class="s">&quot;FRANCE&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="-Symbol">&#39;cID</span><span class="o">,</span> <span class="-Symbol">&#39;cName</span><span class="o">)</span>
  <span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;cID</span><span class="o">,</span> <span class="-Symbol">&#39;cName</span><span class="o">,</span> <span class="-Symbol">&#39;revenue</span><span class="o">.</span><span class="n">sum</span> <span class="nc">AS</span> <span class="-Symbol">&#39;revSum</span><span class="o">)</span>

<span class="c1">// emit or convert Table</span>
<span class="c1">// execute query</span></code></pre></div>

    <p><strong>Note:</strong> The Scala Table API uses Scala Symbols, which start with a single tick (<code>'</code>) to reference the attributes of a <code>Table</code>. The Table API uses Scala implicits. Make sure to import <code>org.apache.flink.api.scala._</code> and <code>org.apache.flink.table.api.scala._</code> in order to use Scala implicit conversions.</p>
  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="sql">SQL</h3>

<p>Flink’s SQL integration is based on <a href="https://calcite.apache.org">Apache Calcite</a>, which implements the SQL standard. SQL queries are specified as regular Strings.</p>

<p>The <a href="/flink-docs/dev/table/sql.html">SQL</a> document describes Flink’s SQL support for streaming and batch tables.</p>

<p>The following example shows how to specify a query and return the result as a Table.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register Orders table</span>

<span class="c1">// compute revenue for all customers from France</span>
<span class="n">Table</span> <span class="n">revenue</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span>
    <span class="s">&quot;SELECT cID, cName, SUM(revenue) AS revSum &quot;</span> <span class="o">+</span>
    <span class="s">&quot;FROM Orders &quot;</span> <span class="o">+</span>
    <span class="s">&quot;WHERE cCountry = &#39;FRANCE&#39; &quot;</span> <span class="o">+</span>
    <span class="s">&quot;GROUP BY cID, cName&quot;</span>
  <span class="o">);</span>

<span class="c1">// emit or convert Table</span>
<span class="c1">// execute query</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// register Orders table</span>

<span class="c1">// compute revenue for all customers from France</span>
<span class="nc">Table</span> <span class="n">revenue</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;&quot;&quot; </span>
<span class="s">  |SELECT cID, cName, SUM(revenue) AS revSum</span>
<span class="s">  |FROM Orders</span>
<span class="s">  |WHERE cCountry = &#39;FRANCE&#39;</span>
<span class="s">  |GROUP BY cID, cName</span>
<span class="s">  &quot;&quot;&quot;</span><span class="o">.</span><span class="n">stripMargin</span><span class="o">)</span>

<span class="c1">// emit or convert Table</span>
<span class="c1">// execute query</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="mixing-table-api-and-sql">Mixing Table API and SQL</h3>

<p>Table API and SQL queries can be easily mixed because both return <code>Table</code> objects:</p>

<ul>
  <li>A Table API query can be defined on the <code>Table</code> object returned by a SQL query.</li>
  <li>A SQL query can be defined on the result of a Table API query by <a href="#register-a-table">registering the resulting Table</a> in the <code>TableEnvironment</code> and referencing it in the <code>FROM</code> clause of the SQL query.</li>
</ul>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="emit-a-table">Emit a Table</h2>

<p>In order to emit a <code>Table</code>, it can be written to a <code>TableSink</code>. A <code>TableSink</code> is a generic interface to support a wide variety of file formats (e.g. CSV, Apache Parquet, Apache Avro), storage systems (e.g., JDBC, Apache HBase, Apache Cassandra, Elasticsearch), or messaging systems (e.g., Apache Kafka, RabbitMQ).</p>

<p>A batch <code>Table</code> can only be written to a <code>BatchTableSink</code>, while a streaming table requires either an <code>AppendStreamTableSink</code>, a <code>RetractStreamTableSink</code>, or an <code>UpsertStreamTableSink</code>.</p>

<p>Please see the documentation about <a href="/flink-docs/dev/table/sourceSinks.html">Table Sources &amp; Sinks</a> for details about available sinks and instructions for how to implement a custom <code>TableSink</code>.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// compute a result Table using Table API operators and/or SQL queries</span>
<span class="n">Table</span> <span class="n">result</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// create a TableSink</span>
<span class="n">TableSink</span> <span class="n">sink</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">CsvTableSink</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="n">fieldDelim</span> <span class="o">=</span> <span class="s">&quot;|&quot;</span><span class="o">);</span>

<span class="c1">// write the result Table to the TableSink</span>
<span class="n">result</span><span class="o">.</span><span class="na">writeToSink</span><span class="o">(</span><span class="n">sink</span><span class="o">);</span>

<span class="c1">// execute the program</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// compute a result Table using Table API operators and/or SQL queries</span>
<span class="k">val</span> <span class="n">result</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// create a TableSink</span>
<span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">TableSink</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvTableSink</span><span class="o">(</span><span class="s">&quot;/path/to/file&quot;</span><span class="o">,</span> <span class="n">fieldDelim</span> <span class="k">=</span> <span class="s">&quot;|&quot;</span><span class="o">)</span>

<span class="c1">// write the result Table to the TableSink</span>
<span class="n">result</span><span class="o">.</span><span class="n">writeToSink</span><span class="o">(</span><span class="n">sink</span><span class="o">)</span>

<span class="c1">// execute the program</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="translate-and-execute-a-query">Translate and Execute a Query</h2>

<p>Table API and SQL queries are translated into <a href="/flink-docs/dev/datastream_api.html">DataStream</a> or <a href="/flink-docs/dev/batch">DataSet</a> programs depending on whether their input is a streaming or batch input. A query is internally represented as a logical query plan and is translated in two phases:</p>

<ol>
  <li>optimization of the logical plan,</li>
  <li>translation into a DataStream or DataSet program.</li>
</ol>

<p>A Table API or SQL query is translated when:</p>

<ul>
  <li>the <code>Table</code> is emitted to a <code>TableSink</code>, i.e., when <code>Table.writeToSink()</code> is called.</li>
  <li>the <code>Table</code> is converted into a <code>DataStream</code> or <code>DataSet</code> (see <a href="#integration-with-dataStream-and-dataSet-api">Integration with DataStream and DataSet API</a>).</li>
</ul>

<p>Once translated, a Table API or SQL query is handled like a regular DataStream or DataSet program and is executed when <code>StreamExecutionEnvironment.execute()</code> or <code>ExecutionEnvironment.execute()</code> is called.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="integration-with-datastream-and-dataset-api">Integration with DataStream and DataSet API</h2>

<p>Table API and SQL queries can be easily integrated with and embedded into <a href="/flink-docs/dev/datastream_api.html">DataStream</a> and <a href="/flink-docs/dev/batch">DataSet</a> programs. For instance, it is possible to query an external table (for example from a RDBMS), do some pre-processing, such as filtering, projecting, aggregating, or joining with meta data, and then further process the data with either the DataStream or DataSet API (and any of the libraries built on top of these APIs, such as CEP or Gelly). Inversely, a Table API or SQL query can also be applied on the result of a DataStream or DataSet program.</p>

<p>This interaction can be achieved by converting a <code>DataStream</code> or <code>DataSet</code> into a <code>Table</code> and vice versa. In this section, we describe how these conversions are done.</p>

<h3 id="implicit-conversion-for-scala">Implicit Conversion for Scala</h3>

<p>The Scala Table API features implicit conversions for the <code>DataSet</code>, <code>DataStream</code>, and <code>Table</code> classes. These conversions are enabled by importing the package <code>org.apache.flink.table.api.scala._</code> in addition to <code>org.apache.flink.api.scala._</code> for the Scala DataStream API.</p>

<h3 id="register-a-datastream-or-dataset-as-table">Register a DataStream or DataSet as Table</h3>

<p>A <code>DataStream</code> or <code>DataSet</code> can be registered in a <code>TableEnvironment</code> as a Table. The schema of the resulting table depends on the data type of the registered <code>DataStream</code> or <code>DataSet</code>. Please check the section about <a href="#mapping-of-data-types-to-table-schema">mapping of data types to table schema</a> for details.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get StreamTableEnvironment</span>
<span class="c1">// registration of a DataSet in a BatchTableEnvironment is equivalent</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// register the DataStream as Table &quot;myTable&quot; with fields &quot;f0&quot;, &quot;f1&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataStream</span><span class="o">(</span><span class="s">&quot;myTable&quot;</span><span class="o">,</span> <span class="n">stream</span><span class="o">);</span>

<span class="c1">// register the DataStream as table &quot;myTable2&quot; with fields &quot;myLong&quot;, &quot;myString&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerDataStream</span><span class="o">(</span><span class="s">&quot;myTable2&quot;</span><span class="o">,</span> <span class="n">stream</span><span class="o">,</span> <span class="s">&quot;myLong, myString&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get TableEnvironment </span>
<span class="c1">// registration of a DataSet is equivalent</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[(</span><span class="kt">Long</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// register the DataStream as Table &quot;myTable&quot; with fields &quot;f0&quot;, &quot;f1&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataStream</span><span class="o">(</span><span class="s">&quot;myTable&quot;</span><span class="o">,</span> <span class="n">stream</span><span class="o">)</span>

<span class="c1">// register the DataStream as table &quot;myTable2&quot; with fields &quot;myLong&quot;, &quot;myString&quot;</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerDataStream</span><span class="o">(</span><span class="s">&quot;myTable2&quot;</span><span class="o">,</span> <span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;myLong</span><span class="o">,</span> <span class="-Symbol">&#39;myString</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><strong>Note:</strong> The name of a <code>DataStream</code> <code>Table</code> must not match the <code>^_DataStreamTable_[0-9]+</code> pattern and the name of a <code>DataSet</code> <code>Table</code> must not match the <code>^_DataSetTable_[0-9]+</code> pattern. These patterns are reserved for internal use only.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="convert-a-datastream-or-dataset-into-a-table">Convert a DataStream or DataSet into a Table</h3>

<p>Instead of registering a <code>DataStream</code> or <code>DataSet</code> in a <code>TableEnvironment</code>, it can also be directly converted into a <code>Table</code>. This is convenient if you want to use the Table in a Table API query.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get StreamTableEnvironment</span>
<span class="c1">// registration of a DataSet in a BatchTableEnvironment is equivalent</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// Convert the DataStream into a Table with default fields &quot;f0&quot;, &quot;f1&quot;</span>
<span class="n">Table</span> <span class="n">table1</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">);</span>

<span class="c1">// Convert the DataStream into a Table with fields &quot;myLong&quot;, &quot;myString&quot;</span>
<span class="n">Table</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="s">&quot;myLong, myString&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get TableEnvironment</span>
<span class="c1">// registration of a DataSet is equivalent</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[(</span><span class="kt">Long</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// convert the DataStream into a Table with default fields &#39;_1, &#39;_2</span>
<span class="k">val</span> <span class="n">table1</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">)</span>

<span class="c1">// convert the DataStream into a Table with fields &#39;myLong, &#39;myString</span>
<span class="k">val</span> <span class="n">table2</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;myLong</span><span class="o">,</span> <span class="-Symbol">&#39;myString</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="convert-a-table-into-a-datastream-or-dataset">Convert a Table into a DataStream or DataSet</h3>

<p>A <code>Table</code> can be converted into a <code>DataStream</code> or <code>DataSet</code>. In this way, custom DataStream or DataSet programs can be run on the result of a Table API or SQL query.</p>

<p>When converting a <code>Table</code> into a <code>DataStream</code> or <code>DataSet</code>, you need to specify the data type of the resulting <code>DataStream</code> or <code>DataSet</code>, i.e., the data type into which the rows of the <code>Table</code> are to be converted. Often the most convenient conversion type is <code>Row</code>. The following list gives an overview of the features of the different options:</p>

<ul>
  <li><strong>Row</strong>: fields are mapped by position, arbitrary number of fields, support for <code>null</code> values, no type-safe access.</li>
  <li><strong>POJO</strong>: fields are mapped by name (POJO fields must be named as <code>Table</code> fields), arbitrary number of fields, support for <code>null</code> values, type-safe access.</li>
  <li><strong>Case Class</strong>: fields are mapped by position, no support for <code>null</code> values, type-safe access.</li>
  <li><strong>Tuple</strong>: fields are mapped by position, limitation to 22 (Scala) or 25 (Java) fields, no support for <code>null</code> values, type-safe access.</li>
  <li><strong>Atomic Type</strong>: <code>Table</code> must have a single field, no support for <code>null</code> values, type-safe access.</li>
</ul>

<h4 id="convert-a-table-into-a-datastream">Convert a Table into a DataStream</h4>

<p>A <code>Table</code> that is the result of a streaming query will be updated dynamically, i.e., it is changing as new records arrive on the query’s input streams. Hence, the <code>DataStream</code> into which such a dynamic query is converted needs to encode the updates of the table.</p>

<p>There are two modes to convert a <code>Table</code> into a <code>DataStream</code>:</p>

<ol>
  <li><strong>Append Mode</strong>: This mode can only be used if the dynamic <code>Table</code> is only modified by <code>INSERT</code> changes, i.e, it is append-only and previously emitted results are never updated.</li>
  <li><strong>Retract Mode</strong>: This mode can always be used. It encodes <code>INSERT</code> and <code>DELETE</code> changes with a <code>boolean</code> flag.</li>
</ol>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get StreamTableEnvironment. </span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// Table with two fields (String name, Integer age)</span>
<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert the Table into an append DataStream of Row by specifying the class</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="n">dsRow</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">toAppendStream</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">Row</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// convert the Table into an append DataStream of Tuple2&lt;String, Integer&gt; </span>
<span class="c1">//   via a TypeInformation</span>
<span class="n">TupleTypeInfo</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">tupleType</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TupleTypeInfo</span><span class="o">&lt;&gt;(</span>
  <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">(),</span>
  <span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">());</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">dsTuple</span> <span class="o">=</span> 
  <span class="n">tableEnv</span><span class="o">.</span><span class="na">toAppendStream</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">tupleType</span><span class="o">);</span>

<span class="c1">// convert the Table into a retract DataStream of Row.</span>
<span class="c1">//   A retract stream of type X is a DataStream&lt;Tuple2&lt;Boolean, X&gt;&gt;. </span>
<span class="c1">//   The boolean field indicates the type of the change. </span>
<span class="c1">//   True is INSERT, false is DELETE.</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">,</span> <span class="n">Row</span><span class="o">&gt;&gt;</span> <span class="n">retractStream</span> <span class="o">=</span> 
  <span class="n">tableEnv</span><span class="o">.</span><span class="na">toRetractStream</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">Row</span><span class="o">.</span><span class="na">class</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get TableEnvironment. </span>
<span class="c1">// registration of a DataSet is equivalent</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// Table with two fields (String name, Integer age)</span>
<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert the Table into an append DataStream of Row</span>
<span class="k">val</span> <span class="n">dsRow</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">toAppendStream</span><span class="o">[</span><span class="kt">Row</span><span class="o">](</span><span class="n">table</span><span class="o">)</span>

<span class="c1">// convert the Table into an append DataStream of Tuple2[String, Int]</span>
<span class="k">val</span> <span class="n">dsTuple</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="n">dsTuple</span> <span class="k">=</span> 
  <span class="n">tableEnv</span><span class="o">.</span><span class="n">toAppendStream</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)](</span><span class="n">table</span><span class="o">)</span>

<span class="c1">// convert the Table into a retract DataStream of Row.</span>
<span class="c1">//   A retract stream of type X is a DataStream[(Boolean, X)]. </span>
<span class="c1">//   The boolean field indicates the type of the change. </span>
<span class="c1">//   True is INSERT, false is DELETE.</span>
<span class="k">val</span> <span class="n">retractStream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[(</span><span class="kt">Boolean</span>, <span class="kt">Row</span><span class="o">)]</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">toRetractStream</span><span class="o">[</span><span class="kt">Row</span><span class="o">](</span><span class="n">table</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><strong>Note:</strong> A detailed discussion about dynamic tables and their properties is given in the <a href="/flink-docs/dev/table/streaming.html">Streaming Queries</a> document.</p>

<h4 id="convert-a-table-into-a-dataset">Convert a Table into a DataSet</h4>

<p>A <code>Table</code> is converted into a <code>DataSet</code> as follows:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get BatchTableEnvironment</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// Table with two fields (String name, Integer age)</span>
<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert the Table into a DataSet of Row by specifying a class</span>
<span class="n">DataSet</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="n">dsRow</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">toDataSet</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">Row</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

<span class="c1">// convert the Table into a DataSet of Tuple2&lt;String, Integer&gt; via a TypeInformation</span>
<span class="n">TupleTypeInfo</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">tupleType</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TupleTypeInfo</span><span class="o">&lt;&gt;(</span>
  <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">(),</span>
  <span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">());</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">dsTuple</span> <span class="o">=</span> 
  <span class="n">tableEnv</span><span class="o">.</span><span class="na">toAppendStream</span><span class="o">(</span><span class="n">table</span><span class="o">,</span> <span class="n">tupleType</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get TableEnvironment </span>
<span class="c1">// registration of a DataSet is equivalent</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// Table with two fields (String name, Integer age)</span>
<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert the Table into a DataSet of Row</span>
<span class="k">val</span> <span class="n">dsRow</span><span class="k">:</span> <span class="kt">DataSet</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">toDataSet</span><span class="o">[</span><span class="kt">Row</span><span class="o">](</span><span class="n">table</span><span class="o">)</span>

<span class="c1">// convert the Table into a DataSet of Tuple2[String, Int]</span>
<span class="k">val</span> <span class="n">dsTuple</span><span class="k">:</span> <span class="kt">DataSet</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">toDataSet</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)](</span><span class="n">table</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="mapping-of-data-types-to-table-schema">Mapping of Data Types to Table Schema</h3>

<p>Flink’s DataStream and DataSet APIs support very diverse types, such as Tuples (built-in Scala and Flink Java tuples), POJOs, case classes, and atomic types. In the following we describe how the Table API converts these types into an internal row representation and show examples of converting a <code>DataStream</code> into a <code>Table</code>.</p>

<h4 id="atomic-types">Atomic Types</h4>

<p>Flink treats primitives (<code>Integer</code>, <code>Double</code>, <code>String</code>) or generic types (types that cannot be analyzed and decomposed) as atomic types. A <code>DataStream</code> or <code>DataSet</code> of an atomic type is converted into a <code>Table</code> with a single attribute. The type of the attribute is inferred from the atomic type and the name of the attribute must be specified.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>
<span class="c1">// convert DataStream into Table with field &quot;myLong&quot;</span>
<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="s">&quot;myLong&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Long</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>
<span class="c1">// convert DataStream into Table with field &#39;myLong</span>
<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;myLong</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<h4 id="tuples-scala-and-java-and-case-classes-scala-only">Tuples (Scala and Java) and Case Classes (Scala only)</h4>

<p>Flink supports Scala’s built-in tuples and provides its own tuple classes for Java. DataStreams and DataSets of both kinds of tuples can be converted into tables. Fields can be renamed by providing names for all fields (mapping based on position). If no field names are specified, the default field names are used.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &quot;myLong&quot;, &quot;myString&quot;</span>
<span class="n">Table</span> <span class="n">table1</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="s">&quot;myLong, myString&quot;</span><span class="o">);</span>

<span class="c1">// convert DataStream into Table with default field names &quot;f0&quot;, &quot;f1&quot;</span>
<span class="n">Table</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[(</span><span class="kt">Long</span>, <span class="kt">String</span><span class="o">)]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &#39;myLong, &#39;myString</span>
<span class="k">val</span> <span class="n">table1</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;myLong</span><span class="o">,</span> <span class="-Symbol">&#39;myString</span><span class="o">)</span>

<span class="c1">// convert DataStream into Table with default field names &#39;_1, &#39;_2</span>
<span class="k">val</span> <span class="n">table2</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">)</span>

<span class="c1">// define case class</span>
<span class="k">case</span> <span class="k">class</span> <span class="nc">Person</span><span class="o">(</span><span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>
<span class="k">val</span> <span class="n">streamCC</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Person</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with default field names &#39;name, &#39;age</span>
<span class="k">val</span> <span class="n">tableCC1</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">streamCC</span><span class="o">)</span>

<span class="c1">// convert DataStream into Table with field names &#39;myName, &#39;myAge</span>
<span class="k">val</span> <span class="n">tableCC1</span> <span class="k">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">streamCC</span><span class="o">,</span> <span class="-Symbol">&#39;myName</span><span class="o">,</span> <span class="-Symbol">&#39;myAge</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<h4 id="pojo-java-and-scala">POJO (Java and Scala)</h4>

<p>Flink supports POJOs as composite types. The rules for what determines a POJO are documented <a href="/flink-docs/dev/api_concepts.html#pojos">here</a>.</p>

<p>When converting a POJO <code>DataStream</code> or <code>DataSet</code> into a <code>Table</code> without specifying field names, the names of the original POJO fields are used. Renaming the original POJO fields requires the keyword <code>AS</code> because POJO fields have no inherent order. The name mapping requires the original names and cannot be done by positions.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// Person is a POJO with fields &quot;name&quot; and &quot;age&quot;</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Person</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &quot;name&quot;, &quot;age&quot;</span>
<span class="n">Table</span> <span class="n">table1</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">);</span>

<span class="c1">// convert DataStream into Table with field names &quot;myName&quot;, &quot;myAge&quot;</span>
<span class="n">Table</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="s">&quot;name as myName, age as myAge&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// Person is a POJO with field names &quot;name&quot; and &quot;age&quot;</span>
<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Person</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &#39;name, &#39;age</span>
<span class="k">val</span> <span class="n">table1</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">)</span>

<span class="c1">// convert DataStream into Table with field names &#39;myName, &#39;myAge</span>
<span class="k">val</span> <span class="n">table2</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;name</span> <span class="n">as</span> <span class="-Symbol">&#39;myName</span><span class="o">,</span> <span class="-Symbol">&#39;age</span> <span class="n">as</span> <span class="-Symbol">&#39;myAge</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<h4 id="row">Row</h4>

<p>The Row data type supports an arbitrary number of fields and fields with <code>null</code> values. Field names can be specified via a <code>RowTypeInfo</code> or when converting a <code>Row</code> <code>DataStream</code> or <code>DataSet</code> into a <code>Table</code> (based on position).</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// get a StreamTableEnvironment, works for BatchTableEnvironment equivalently</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// DataStream of Row with two fields &quot;name&quot; and &quot;age&quot; specified in `RowTypeInfo`</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="n">stream</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &quot;name&quot;, &quot;age&quot;</span>
<span class="n">Table</span> <span class="n">table1</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">);</span>

<span class="c1">// convert DataStream into Table with field names &quot;myName&quot;, &quot;myAge&quot;</span>
<span class="n">Table</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="s">&quot;myName, myAge&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// get a TableEnvironment</span>
<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// DataStream of Row with two fields &quot;name&quot; and &quot;age&quot; specified in `RowTypeInfo`</span>
<span class="k">val</span> <span class="n">stream</span><span class="k">:</span> <span class="kt">DataStream</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">...</span>

<span class="c1">// convert DataStream into Table with field names &#39;name, &#39;age</span>
<span class="k">val</span> <span class="n">table1</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">)</span>

<span class="c1">// convert DataStream into Table with field names &#39;myName, &#39;myAge</span>
<span class="k">val</span> <span class="n">table2</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="n">tableEnv</span><span class="o">.</span><span class="n">fromDataStream</span><span class="o">(</span><span class="n">stream</span><span class="o">,</span> <span class="-Symbol">&#39;myName</span><span class="o">,</span> <span class="-Symbol">&#39;myAge</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="query-optimization">Query Optimization</h2>

<p>Apache Flink leverages Apache Calcite to optimize and translate queries. The optimization currently performed include projection and filter push-down, subquery decorrelation, and other kinds of query rewriting. Flink does not yet optimize the order of joins, but executes them in the same order as defined in the query (order of Tables in the <code>FROM</code> clause and/or order of join predicates in the <code>WHERE</code> clause).</p>

<p>It is possible to tweak the set of optimization rules which are applied in different phases by providing a <code>CalciteConfig</code> object. This can be created via a builder by calling <code>CalciteConfig.createBuilder())</code> and is provided to the TableEnvironment by calling <code>tableEnv.getConfig.setCalciteConfig(calciteConfig)</code>.</p>

<h3 id="explaining-a-table">Explaining a Table</h3>

<p>The Table API provides a mechanism to explain the logical and optimized query plans to compute a <code>Table</code>. 
This is done through the <code>TableEnvironment.explain(table)</code> method. It returns a String describing three plans:</p>

<ol>
  <li>the Abstract Syntax Tree of the relational query, i.e., the unoptimized logical query plan,</li>
  <li>the optimized logical query plan, and</li>
  <li>the physical execution plan.</li>
</ol>

<p>The following code shows an example and the corresponding output:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">StreamExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">StreamTableEnvironment</span> <span class="n">tEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">stream1</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">fromElements</span><span class="o">(</span><span class="k">new</span> <span class="n">Tuple2</span><span class="o">&lt;&gt;(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;hello&quot;</span><span class="o">));</span>
<span class="n">DataStream</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">stream2</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="na">fromElements</span><span class="o">(</span><span class="k">new</span> <span class="n">Tuple2</span><span class="o">&lt;&gt;(</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;hello&quot;</span><span class="o">));</span>

<span class="n">Table</span> <span class="n">table1</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream1</span><span class="o">,</span> <span class="s">&quot;count, word&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">table2</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">fromDataStream</span><span class="o">(</span><span class="n">stream2</span><span class="o">,</span> <span class="s">&quot;count, word&quot;</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="n">table1</span>
  <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="s">&quot;LIKE(word, &#39;F%&#39;)&quot;</span><span class="o">)</span>
  <span class="o">.</span><span class="na">unionAll</span><span class="o">(</span><span class="n">table2</span><span class="o">);</span>

<span class="n">String</span> <span class="n">explanation</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="na">explain</span><span class="o">(</span><span class="n">table</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">explanation</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">env</span> <span class="k">=</span> <span class="nc">StreamExecutionEnvironment</span><span class="o">.</span><span class="n">getExecutionEnvironment</span>
<span class="k">val</span> <span class="n">tEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="k">val</span> <span class="n">table1</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">fromElements</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;hello&quot;</span><span class="o">)).</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">,</span> <span class="-Symbol">&#39;count</span><span class="o">,</span> <span class="-Symbol">&#39;word</span><span class="o">)</span>
<span class="k">val</span> <span class="n">table2</span> <span class="k">=</span> <span class="n">env</span><span class="o">.</span><span class="n">fromElements</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span> <span class="s">&quot;hello&quot;</span><span class="o">)).</span><span class="n">toTable</span><span class="o">(</span><span class="n">tEnv</span><span class="o">,</span> <span class="-Symbol">&#39;count</span><span class="o">,</span> <span class="-Symbol">&#39;word</span><span class="o">)</span>
<span class="k">val</span> <span class="n">table</span> <span class="k">=</span> <span class="n">table1</span>
  <span class="o">.</span><span class="n">where</span><span class="o">(</span><span class="-Symbol">&#39;word</span><span class="o">.</span><span class="n">like</span><span class="o">(</span><span class="s">&quot;F%&quot;</span><span class="o">))</span>
  <span class="o">.</span><span class="n">unionAll</span><span class="o">(</span><span class="n">table2</span><span class="o">)</span>

<span class="k">val</span> <span class="n">explanation</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="n">tEnv</span><span class="o">.</span><span class="n">explain</span><span class="o">(</span><span class="n">table</span><span class="o">)</span>
<span class="n">println</span><span class="o">(</span><span class="n">explanation</span><span class="o">)</span></code></pre></div>

  </div>
</div>

<div class="highlight"><pre><code class="language-text" data-lang="text">== Abstract Syntax Tree ==
LogicalUnion(all=[true])
  LogicalFilter(condition=[LIKE($1, &#39;F%&#39;)])
    LogicalTableScan(table=[[_DataStreamTable_0]])
  LogicalTableScan(table=[[_DataStreamTable_1]])

== Optimized Logical Plan ==
DataStreamUnion(union=[count, word])
  DataStreamCalc(select=[count, word], where=[LIKE(word, &#39;F%&#39;)])
    DataStreamScan(table=[[_DataStreamTable_0]])
  DataStreamScan(table=[[_DataStreamTable_1]])

== Physical Execution Plan ==
Stage 1 : Data Source
  content : collect elements with CollectionInputFormat

Stage 2 : Data Source
  content : collect elements with CollectionInputFormat

  Stage 3 : Operator
    content : from: (count, word)
    ship_strategy : REBALANCE

    Stage 4 : Operator
      content : where: (LIKE(word, &#39;F%&#39;)), select: (count, word)
      ship_strategy : FORWARD

      Stage 5 : Operator
        content : from: (count, word)
        ship_strategy : REBALANCE</code></pre></div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



        </div>
      </div>
    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="/flink-docs/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
