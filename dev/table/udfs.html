<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.4-SNAPSHOT Documentation: User-defined Functions</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/favicon.ico" type="image/x-icon">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          







  
    
    
    
      
    
  

  
    
    
    
      
    
  

  
    
    
    
      









  





<div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/img/navbar-brand-logo.jpg"></a> v1.4-SNAPSHOT</p>
</div>
<ul id="sidenav">

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/index.html"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li>
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/concepts/programming-model.html">Programming Model</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/concepts/runtime.html">Distributed Runtime</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/quickstart/setup_quickstart.html"><i class="fa fa-power-off title appetizer" aria-hidden="true"></i> Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-7" data-toggle="collapse"><i class="fa fa-file-code-o title appetizer" aria-hidden="true"></i> Examples <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-7"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/examples/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/quickstart/run_example_quickstart.html">Monitoring Wikipedia Edits</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/examples.html">Batch Examples</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-11" data-toggle="collapse"><i class="fa fa-book title appetizer" aria-hidden="true"></i> Cookbook <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-11"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/cookbook/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/cookbook/stream-enrichment-join.html">Stream Enrichment Join</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/cookbook/pattern-detection.html">Pattern Detection with CEP</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-cogs title maindish" aria-hidden="true"></i> Project Setup <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/quickstart/java_api_quickstart.html">Sample Project in Java</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/quickstart/scala_api_quickstart.html">Sample Project in Scala</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/linking_with_flink.html">Linking with Flink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/ide_setup.html">IDE Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/scala_shell.html">Scala REPL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/linking.html">Linking with Optional Modules</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/start/flink_on_windows.html">Running Flink on Windows</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/start/building.html">Building Flink from Source</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-25" data-toggle="collapse" class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</a><div class="collapse in" id="collapse-25"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-26" data-toggle="collapse">Basic API Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-26"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/api_concepts.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/scala_api_extensions.html">Scala API Extensions</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/java8.html">Java 8</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-30" data-toggle="collapse">Streaming (DataStream API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-30"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/datastream_api.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-31" data-toggle="collapse">Event Time <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-31"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/event_time.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/event_timestamps_watermarks.html">Generating Timestamps / Watermarks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/event_timestamp_extractors.html">Pre-defined Timestamp Extractors / Watermark Emitters</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-35" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-35"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/state.html">Working with State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/checkpointing.html">Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/queryable_state.html">Queryable State</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/state/custom_serialization.html">Custom Serialization</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-42" data-toggle="collapse">Operators <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-42"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/operators/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/operators/windows.html">Windows</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/operators/process_function.html">Process Function</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/operators/asyncio.html">Async I/O</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-47" data-toggle="collapse">Connectors <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-47"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/guarantees.html">Fault Tolerance Guarantees</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/kafka.html">Kafka</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/cassandra.html">Cassandra</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/kinesis.html">Kinesis</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/filesystem_sink.html">Rolling File Sink</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/nifi.html">NiFi</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/connectors/twitter.html">Twitter</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/side_output.html">Side Outputs</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/stream/testing.html">Testing</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-61" data-toggle="collapse">Batch (DataSet API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-61"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/dataset_transformations.html">Transformations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/iterations.html">Iterations</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/fault_tolerance.html">Fault Tolerance</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/python.html">Python API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/connectors.html">Connectors</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/batch/hadoop_compatibility.html">Hadoop Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/local_execution.html">Local Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/cluster_execution.html">Cluster Execution</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-72" data-toggle="collapse" class="active">Table API & SQL</a><div class="collapse in" id="collapse-72"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/common.html">Concepts & Common API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/streaming.html">Streaming Concepts</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/tableApi.html">Table API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/sql.html">SQL</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/sourceSinks.html">Table Sources & Sinks</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/udfs.html" class="active">User-defined Functions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-80" data-toggle="collapse">Data Types & Serialization <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-80"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/types_serialization.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/custom_serializers.html">Custom Serializers</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-83" data-toggle="collapse">Managing Execution <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-83"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/execution_configuration.html">Execution Configuration</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/packaging.html">Program Packaging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/parallel.html">Parallel Execution</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/execution_plans.html">Execution Plans</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/restart_strategies.html">Restart Strategies</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-90" data-toggle="collapse">Libraries <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-90"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/cep.html">Event Processing (CEP)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/storm_compatibility.html">Storm Compatibility</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-93" data-toggle="collapse">Graphs: Gelly <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-93"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/graph_api.html">Graph API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/library_methods.html">Library Methods</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-101" data-toggle="collapse">Machine Learning <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-101"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/index.html">Overview</a></li>
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/quickstart.html">Quickstart</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/multiple_linear_regression.html">Multiple Linear Regression</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/cross_validation.html">Cross Validation</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/distance_metrics.html">Distance Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/knn.html">k-Nearest Neighbors Join</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/min_max_scaler.html">MinMax Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/contribution_guide.html">How to Contribute</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/pipelines.html">Pipelines</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/polynomial_features.html">Polynomial Features</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/als.html">ALS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/sos.html">Stochastic Outlier Selection</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/standard_scaler.html">Standard Scaler</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/libs/ml/svm.html">SVM using CoCoA</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/best_practices.html">Best Practices</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/migration.html">API Migration Guides</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-120" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i> Deployment & Operations <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-120"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-121" data-toggle="collapse">Clusters & Deployment <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-121"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/cluster_setup.html">Standalone Cluster</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/yarn_setup.html">YARN</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/mesos.html">Mesos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/docker.html">Docker</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/kubernetes.html">Kubernetes</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/aws.html">AWS</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/gce_setup.html">Google Compute Engine</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/deployment/mapr_setup.html">MapR</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/jobmanager_high_availability.html">High Availability (HA)</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-132" data-toggle="collapse">State & Fault Tolerance <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-132"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/state/checkpoints.html">Checkpoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/state/savepoints.html">Savepoints</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/state/state_backends.html">State Backends</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/config.html">Configuration</a></li>
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/production_ready.html">Production Readiness Checklist</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/cli.html">CLI</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/security-kerberos.html">Kerberos</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/security-ssl.html">SSL Setup</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/ops/upgrading.html">Upgrading Applications and Flink Versions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-145" data-toggle="collapse"><i class="fa fa-bug title maindish" aria-hidden="true"></i> Debugging & Monitoring <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-145"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/metrics.html">Metrics</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/logging.html">Logging</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/historyserver.html">History Server</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/checkpoint_monitoring.html">Monitoring Checkpointing</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/back_pressure.html">Monitoring Back Pressure</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/rest_api.html">Monitoring REST API</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/debugging_event_time.html">Debugging Windows & Event Time</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/debugging_classloading.html">Debugging Classloading</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/monitoring/application_profiling.html">Application Profiling</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    
      
    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-156" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i> Internals <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-156"><ul>
  
        
        
        

        
        
      
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/components.html">Component Stack</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/job_scheduling.html">Jobs and Scheduling</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/task_lifecycle.html">Task Lifecycle</a></li>
    
  

  
    

    
      
    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/internals/filesystems.html">File Systems</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
  <li class="divider"></li>
  <li><a href="https://ci.apache.org/projects/flink/flink-docs-release-1.4/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-release-1.4/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
      
    </ul>
  </div>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">
          

          





  
  
    
    
      
    
  

  
  
    
    
      
    
  

  
  
    
    
      



<ol class="breadcrumb">

  
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</li>
  

  
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-release-1.4/dev/table/index.html">Table API & SQL</a></li>
  

  
  
    <li class="active">User-defined Functions</li>
  

</ol>

<h1>User-defined Functions</h1>




<p>User-defined functions are an important feature, because they significantly extend the expressiveness of queries.</p>

<p><strong>TODO</strong></p>

<ul id="markdown-toc">
  <li><a href="#register-user-defined-functions" id="markdown-toc-register-user-defined-functions">Register User-Defined Functions</a></li>
  <li><a href="#scalar-functions" id="markdown-toc-scalar-functions">Scalar Functions</a></li>
  <li><a href="#table-functions" id="markdown-toc-table-functions">Table Functions</a></li>
  <li><a href="#aggregation-functions" id="markdown-toc-aggregation-functions">Aggregation Functions</a></li>
  <li><a href="#integrating-udfs-with-the-runtime" id="markdown-toc-integrating-udfs-with-the-runtime">Integrating UDFs with the Runtime</a></li>
</ul>

<h2 id="register-user-defined-functions">Register User-Defined Functions</h2>

<p><strong>TODO</strong></p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="scalar-functions">Scalar Functions</h2>

<p>If a required scalar function is not contained in the built-in functions, it is possible to define custom, user-defined scalar functions for both the Table API and SQL. A user-defined scalar functions maps zero, one, or multiple scalar values to a new scalar value.</p>

<p>In order to define a scalar function one has to extend the base class <code>ScalarFunction</code> in <code>org.apache.flink.table.functions</code> and implement (one or more) evaluation methods. The behavior of a scalar function is determined by the evaluation method. An evaluation method must be declared publicly and named <code>eval</code>. The parameter types and return type of the evaluation method also determine the parameter and return types of the scalar function. Evaluation methods can also be overloaded by implementing multiple methods named <code>eval</code>.</p>

<p>The following example shows how to define your own hash code function, register it in the TableEnvironment, and call it in a query. Note that you can configure your scalar function via a constructor before it is registered:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashCode</span> <span class="kd">extends</span> <span class="n">ScalarFunction</span> <span class="o">{</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">12</span><span class="o">;</span>
  
  <span class="kd">public</span> <span class="nf">HashCode</span><span class="o">(</span><span class="kt">int</span> <span class="n">factor</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">this</span><span class="o">.</span><span class="na">factor</span> <span class="o">=</span> <span class="n">factor</span><span class="o">;</span>
  <span class="o">}</span>
  
  <span class="kd">public</span> <span class="kt">int</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">*</span> <span class="n">factor</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// register the function</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">&quot;hashCode&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">HashCode</span><span class="o">(</span><span class="mi">10</span><span class="o">));</span>

<span class="c1">// use the function in Java Table API</span>
<span class="n">myTable</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;string, string.hashCode(), hashCode(string)&quot;</span><span class="o">);</span>

<span class="c1">// use the function in SQL API</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT string, HASHCODE(string) FROM MyTable&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// must be defined in static/object context</span>
<span class="k">class</span> <span class="nc">HashCode</span><span class="o">(</span><span class="n">factor</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">ScalarFunction</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">eval</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">s</span><span class="o">.</span><span class="n">hashCode</span><span class="o">()</span> <span class="o">*</span> <span class="n">factor</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// use the function in Scala Table API</span>
<span class="k">val</span> <span class="n">hashCode</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">HashCode</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
<span class="n">myTable</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;string</span><span class="o">,</span> <span class="n">hashCode</span><span class="o">(</span><span class="-Symbol">&#39;string</span><span class="o">))</span>

<span class="c1">// register and use the function in SQL</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerFunction</span><span class="o">(</span><span class="s">&quot;hashCode&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nc">HashCode</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT string, HASHCODE(string) FROM MyTable&quot;</span><span class="o">);</span></code></pre></div>

  </div>
</div>

<p>By default the result type of an evaluation method is determined by Flink’s type extraction facilities. This is sufficient for basic types or simple POJOs but might be wrong for more complex, custom, or composite types. In these cases <code>TypeInformation</code> of the result type can be manually defined by overriding <code>ScalarFunction#getResultType()</code>.</p>

<p>Internally, the Table API and SQL code generation works with primitive values as much as possible. If a user-defined scalar function should not introduce much overhead through object creation/casting during runtime, it is recommended to declare parameters and result types as primitive types instead of their boxed classes. <code>Types.DATE</code> and <code>Types.TIME</code> can also be represented as <code>int</code>. <code>Types.TIMESTAMP</code> can be represented as <code>long</code>.</p>

<p>The following example shows an advanced example which takes the internal timestamp representation and also returns the internal timestamp representation as a long value. By overriding <code>ScalarFunction#getResultType()</code> we define that the returned long value should be interpreted as a <code>Types.TIMESTAMP</code> by the code generation.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">TimestampModifier</span> <span class="kd">extends</span> <span class="n">ScalarFunction</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kt">long</span> <span class="nf">eval</span><span class="o">(</span><span class="kt">long</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">t</span> <span class="o">%</span> <span class="mi">1000</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kd">public</span> <span class="n">TypeInformation</span><span class="o">&lt;?&gt;</span> <span class="n">getResultType</span><span class="o">(</span><span class="nl">signature:</span> <span class="n">Class</span><span class="o">&lt;?&gt;[])</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Types</span><span class="o">.</span><span class="na">TIMESTAMP</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">object</span> <span class="nc">TimestampModifier</span> <span class="k">extends</span> <span class="nc">ScalarFunction</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">eval</span><span class="o">(</span><span class="n">t</span><span class="k">:</span> <span class="kt">Long</span><span class="o">)</span><span class="k">:</span> <span class="kt">Long</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">t</span> <span class="o">%</span> <span class="mi">1000</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">getResultType</span><span class="o">(</span><span class="n">signature</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Class</span><span class="o">[</span><span class="k">_</span><span class="o">]])</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="nc">Types</span><span class="o">.</span><span class="nc">TIMESTAMP</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="table-functions">Table Functions</h2>

<p>Similar to a user-defined scalar function, a user-defined table function takes zero, one, or multiple scalar values as input parameters. However in contrast to a scalar function, it can return an arbitrary number of rows as output instead of a single value. The returned rows may consist of one or more columns.</p>

<p>In order to define a table function one has to extend the base class <code>TableFunction</code> in <code>org.apache.flink.table.functions</code> and implement (one or more) evaluation methods. The behavior of a table function is determined by its evaluation methods. An evaluation method must be declared <code>public</code> and named <code>eval</code>. The <code>TableFunction</code> can be overloaded by implementing multiple methods named <code>eval</code>. The parameter types of the evaluation methods determine all valid parameters of the table function. The type of the returned table is determined by the generic type of <code>TableFunction</code>. Evaluation methods emit output rows using the protected <code>collect(T)</code> method.</p>

<p>In the Table API, a table function is used with <code>.join(Expression)</code> or <code>.leftOuterJoin(Expression)</code> for Scala users and <code>.join(String)</code> or <code>.leftOuterJoin(String)</code> for Java users. The <code>join</code> operator (cross) joins each row from the outer table (table on the left of the operator) with all rows produced by the table-valued function (which is on the right side of the operator). The <code>leftOuterJoin</code> operator joins each row from the outer table (table on the left of the operator) with all rows produced by the table-valued function (which is on the right side of the operator) and preserves outer rows for which the table function returns an empty table. In SQL use <code>LATERAL TABLE(&lt;TableFunction&gt;)</code> with CROSS JOIN and LEFT JOIN with an ON TRUE join condition (see examples below).</p>

<p>The following example shows how to define table-valued function, register it in the TableEnvironment, and call it in a query. Note that you can configure your table function via a constructor before it is registered:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// The generic type &quot;Tuple2&lt;String, Integer&gt;&quot; determines the schema of the returned table as (String, Integer).</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Split</span> <span class="kd">extends</span> <span class="n">TableFunction</span><span class="o">&lt;</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">separator</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">;</span>
    
    <span class="kd">public</span> <span class="nf">Split</span><span class="o">(</span><span class="n">String</span> <span class="n">separator</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">separator</span> <span class="o">=</span> <span class="n">separator</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">str</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="n">separator</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// use collect(...) to emit a row</span>
            <span class="n">collect</span><span class="o">(</span><span class="k">new</span> <span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Integer</span><span class="o">&gt;(</span><span class="n">s</span><span class="o">,</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">()));</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>
<span class="n">Table</span> <span class="n">myTable</span> <span class="o">=</span> <span class="o">...</span>         <span class="c1">// table schema: [a: String]</span>

<span class="c1">// Register the function.</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">&quot;split&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">Split</span><span class="o">(</span><span class="s">&quot;#&quot;</span><span class="o">));</span>

<span class="c1">// Use the table function in the Java Table API. &quot;as&quot; specifies the field names of the table.</span>
<span class="n">myTable</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="s">&quot;split(a) as (word, length)&quot;</span><span class="o">).</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;a, word, length&quot;</span><span class="o">);</span>
<span class="n">myTable</span><span class="o">.</span><span class="na">leftOuterJoin</span><span class="o">(</span><span class="s">&quot;split(a) as (word, length)&quot;</span><span class="o">).</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;a, word, length&quot;</span><span class="o">);</span>

<span class="c1">// Use the table function in SQL with LATERAL and TABLE keywords.</span>
<span class="c1">// CROSS JOIN a table function (equivalent to &quot;join&quot; in Table API).</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT a, word, length FROM MyTable, LATERAL TABLE(split(a)) as T(word, length)&quot;</span><span class="o">);</span>
<span class="c1">// LEFT JOIN a table function (equivalent to &quot;leftOuterJoin&quot; in Table API).</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT a, word, length FROM MyTable LEFT JOIN LATERAL TABLE(split(a)) as T(word, length) ON TRUE&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// The generic type &quot;(String, Int)&quot; determines the schema of the returned table as (String, Integer).</span>
<span class="k">class</span> <span class="nc">Split</span><span class="o">(</span><span class="n">separator</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">TableFunction</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">eval</span><span class="o">(</span><span class="n">str</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// use collect(...) to emit a row.</span>
    <span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="n">separator</span><span class="o">).</span><span class="n">foreach</span><span class="o">(</span><span class="n">x</span> <span class="o">-&gt;</span> <span class="n">collect</span><span class="o">((</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span><span class="o">.</span><span class="n">length</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>
<span class="k">val</span> <span class="n">myTable</span> <span class="k">=</span> <span class="o">...</span>         <span class="c1">// table schema: [a: String]</span>

<span class="c1">// Use the table function in the Scala Table API (Note: No registration required in Scala Table API).</span>
<span class="k">val</span> <span class="n">split</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Split</span><span class="o">(</span><span class="s">&quot;#&quot;</span><span class="o">)</span>
<span class="c1">// &quot;as&quot; specifies the field names of the generated table.</span>
<span class="n">myTable</span><span class="o">.</span><span class="n">join</span><span class="o">(</span><span class="n">split</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">)</span> <span class="n">as</span> <span class="o">(</span><span class="-Symbol">&#39;word</span><span class="o">,</span> <span class="-Symbol">&#39;length</span><span class="o">)).</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;word</span><span class="o">,</span> <span class="-Symbol">&#39;length</span><span class="o">);</span>
<span class="n">myTable</span><span class="o">.</span><span class="n">leftOuterJoin</span><span class="o">(</span><span class="n">split</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">)</span> <span class="n">as</span> <span class="o">(</span><span class="-Symbol">&#39;word</span><span class="o">,</span> <span class="-Symbol">&#39;length</span><span class="o">)).</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;a</span><span class="o">,</span> <span class="-Symbol">&#39;word</span><span class="o">,</span> <span class="-Symbol">&#39;length</span><span class="o">);</span>

<span class="c1">// Register the table function to use it in SQL queries.</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerFunction</span><span class="o">(</span><span class="s">&quot;split&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Split</span><span class="o">(</span><span class="s">&quot;#&quot;</span><span class="o">))</span>

<span class="c1">// Use the table function in SQL with LATERAL and TABLE keywords.</span>
<span class="c1">// CROSS JOIN a table function (equivalent to &quot;join&quot; in Table API)</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT a, word, length FROM MyTable, LATERAL TABLE(split(a)) as T(word, length)&quot;</span><span class="o">);</span>
<span class="c1">// LEFT JOIN a table function (equivalent to &quot;leftOuterJoin&quot; in Table API)</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT a, word, length FROM MyTable LEFT JOIN TABLE(split(a)) as T(word, length) ON TRUE&quot;</span><span class="o">);</span></code></pre></div>

    <p><strong>IMPORTANT:</strong> Do not implement TableFunction as a Scala object. Scala object is a singleton and will cause concurrency issues.</p>
  </div>
</div>

<p>Please note that POJO types do not have a deterministic field order. Therefore, you cannot rename the fields of POJO returned by a table function using <code>AS</code>.</p>

<p>By default the result type of a <code>TableFunction</code> is determined by Flink’s automatic type extraction facilities. This works well for basic types and simple POJOs but might be wrong for more complex, custom, or composite types. In such a case, the type of the result can be manually specified by overriding <code>TableFunction#getResultType()</code> which returns its <code>TypeInformation</code>.</p>

<p>The following example shows an example of a <code>TableFunction</code> that returns a <code>Row</code> type which requires explicit type information. We define that the returned table type should be <code>RowTypeInfo(String, Integer)</code> by overriding <code>TableFunction#getResultType()</code>.</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomTypeSplit</span> <span class="kd">extends</span> <span class="n">TableFunction</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">str</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">s</span> <span class="o">:</span> <span class="n">str</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Row</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
            <span class="n">row</span><span class="o">.</span><span class="na">setField</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">s</span><span class="o">);</span>
            <span class="n">row</span><span class="o">.</span><span class="na">setField</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">s</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
            <span class="n">collect</span><span class="o">(</span><span class="n">row</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">TypeInformation</span><span class="o">&lt;</span><span class="n">Row</span><span class="o">&gt;</span> <span class="nf">getResultType</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">RowTypeInfo</span><span class="o">(</span><span class="k">new</span> <span class="n">TypeInformation</span><span class="o">[]{</span>
               			<span class="n">BasicTypeInfo</span><span class="o">.</span><span class="na">STRING_TYPE_INFO</span><span class="o">,</span> <span class="n">BasicTypeInfo</span><span class="o">.</span><span class="na">INT_TYPE_INFO</span><span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">class</span> <span class="nc">CustomTypeSplit</span> <span class="k">extends</span> <span class="nc">TableFunction</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">eval</span><span class="o">(</span><span class="n">str</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">).</span><span class="n">foreach</span><span class="o">({</span> <span class="n">s</span> <span class="k">=&gt;</span>
      <span class="k">val</span> <span class="n">row</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Row</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
      <span class="n">row</span><span class="o">.</span><span class="n">setField</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">s</span><span class="o">)</span>
      <span class="n">row</span><span class="o">.</span><span class="n">setField</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">s</span><span class="o">.</span><span class="n">length</span><span class="o">)</span>
      <span class="n">collect</span><span class="o">(</span><span class="n">row</span><span class="o">)</span>
    <span class="o">})</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">getResultType</span><span class="k">:</span> <span class="kt">TypeInformation</span><span class="o">[</span><span class="kt">Row</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nc">RowTypeInfo</span><span class="o">(</span><span class="nc">Seq</span><span class="o">(</span><span class="nc">BasicTypeInfo</span><span class="o">.</span><span class="nc">STRING_TYPE_INFO</span><span class="o">,</span>
                        <span class="nc">BasicTypeInfo</span><span class="o">.</span><span class="nc">INT_TYPE_INFO</span><span class="o">))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="aggregation-functions">Aggregation Functions</h2>

<p><strong>TODO</strong></p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="integrating-udfs-with-the-runtime">Integrating UDFs with the Runtime</h2>

<p>Sometimes it might be necessary for a user-defined function to get global runtime information or do some setup/clean-up work before the actual work. User-defined functions provide <code>open()</code> and <code>close()</code> methods that can be overriden and provide similar functionality as the methods in <code>RichFunction</code> of DataSet or DataStream API.</p>

<p>The <code>open()</code> method is called once before the evaluation method. The <code>close()</code> method after the last call to the evaluation method.</p>

<p>The <code>open()</code> method provides a <code>FunctionContext</code> that contains information about the context in which user-defined functions are executed, such as the metric group, the distributed cache files, or the global job parameters.</p>

<p>The following information can be obtained by calling the corresponding methods of <code>FunctionContext</code>:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Method</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>getMetricGroup()</code></td>
      <td style="text-align: left">Metric group for this parallel subtask.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>getCachedFile(name)</code></td>
      <td style="text-align: left">Local temporary file copy of a distributed cache file.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>getJobParameter(name, defaultValue)</code></td>
      <td style="text-align: left">Global job parameter value associated with given key.</td>
    </tr>
  </tbody>
</table>

<p>The following example snippet shows how to use <code>FunctionContext</code> in a scalar function for accessing a global job parameter:</p>

<div class="codetabs">
  <div data-lang="java">

    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">HashCode</span> <span class="kd">extends</span> <span class="n">ScalarFunction</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">open</span><span class="o">(</span><span class="n">FunctionContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// access &quot;hashcode_factor&quot; parameter</span>
        <span class="c1">// &quot;12&quot; would be the default value if parameter does not exist</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getJobParameter</span><span class="o">(</span><span class="s">&quot;hashcode_factor&quot;</span><span class="o">,</span> <span class="s">&quot;12&quot;</span><span class="o">));</span> 
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">eval</span><span class="o">(</span><span class="n">String</span> <span class="n">s</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">*</span> <span class="n">factor</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">ExecutionEnvironment</span> <span class="n">env</span> <span class="o">=</span> <span class="n">ExecutionEnvironment</span><span class="o">.</span><span class="na">getExecutionEnvironment</span><span class="o">();</span>
<span class="n">BatchTableEnvironment</span> <span class="n">tableEnv</span> <span class="o">=</span> <span class="n">TableEnvironment</span><span class="o">.</span><span class="na">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">);</span>

<span class="c1">// set job parameter</span>
<span class="n">Configuration</span> <span class="n">conf</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Configuration</span><span class="o">();</span>
<span class="n">conf</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="s">&quot;hashcode_factor&quot;</span><span class="o">,</span> <span class="s">&quot;31&quot;</span><span class="o">);</span>
<span class="n">env</span><span class="o">.</span><span class="na">getConfig</span><span class="o">().</span><span class="na">setGlobalJobParameters</span><span class="o">(</span><span class="n">conf</span><span class="o">);</span>

<span class="c1">// register the function</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerFunction</span><span class="o">(</span><span class="s">&quot;hashCode&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="nf">HashCode</span><span class="o">());</span>

<span class="c1">// use the function in Java Table API</span>
<span class="n">myTable</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="s">&quot;string, string.hashCode(), hashCode(string)&quot;</span><span class="o">);</span>

<span class="c1">// use the function in SQL</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="na">sql</span><span class="o">(</span><span class="s">&quot;SELECT string, HASHCODE(string) FROM MyTable&quot;</span><span class="o">);</span></code></pre></div>

  </div>

  <div data-lang="scala">

    <div class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">object</span> <span class="nc">hashCode</span> <span class="k">extends</span> <span class="nc">ScalarFunction</span> <span class="o">{</span>

  <span class="k">var</span> <span class="n">hashcode_factor</span> <span class="k">=</span> <span class="mi">12</span><span class="o">;</span>

  <span class="k">override</span> <span class="k">def</span> <span class="n">open</span><span class="o">(</span><span class="n">context</span><span class="k">:</span> <span class="kt">FunctionContext</span><span class="o">)</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// access &quot;hashcode_factor&quot; parameter</span>
    <span class="c1">// &quot;12&quot; would be the default value if parameter does not exist</span>
    <span class="n">hashcode_factor</span> <span class="k">=</span> <span class="n">context</span><span class="o">.</span><span class="n">getJobParameter</span><span class="o">(</span><span class="s">&quot;hashcode_factor&quot;</span><span class="o">,</span> <span class="s">&quot;12&quot;</span><span class="o">).</span><span class="n">toInt</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">eval</span><span class="o">(</span><span class="n">s</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
    <span class="n">s</span><span class="o">.</span><span class="n">hashCode</span><span class="o">()</span> <span class="o">*</span> <span class="n">hashcode_factor</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">tableEnv</span> <span class="k">=</span> <span class="nc">TableEnvironment</span><span class="o">.</span><span class="n">getTableEnvironment</span><span class="o">(</span><span class="n">env</span><span class="o">)</span>

<span class="c1">// use the function in Scala Table API</span>
<span class="n">myTable</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="-Symbol">&#39;string</span><span class="o">,</span> <span class="n">hashCode</span><span class="o">(</span><span class="-Symbol">&#39;string</span><span class="o">))</span>

<span class="c1">// register and use the function in SQL</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerFunction</span><span class="o">(</span><span class="s">&quot;hashCode&quot;</span><span class="o">,</span> <span class="n">hashCode</span><span class="o">)</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">sql</span><span class="o">(</span><span class="s">&quot;SELECT string, HASHCODE(string) FROM MyTable&quot;</span><span class="o">);</span></code></pre></div>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>



        </div>
      </div>
    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-release-1.4/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
